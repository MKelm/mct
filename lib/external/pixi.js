/*
 * @license
 * Pixi.JS - v1.3.0 custom build
 * Copyright (c) 2012, Mat Groves
 * http://goodboydigital.com/
 *
 * Compiled: 2013-08-13
 *
 * Includes atlas file loader and text word wrap improvements
 * by Martin Kelm (http://github.com/mkelm)
 *
 * Pixi.JS is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(){function K(c){return[(c>>16&255)/255,(c>>8&255)/255,(c&255)/255]}function K(c){return[(c>>16&255)/255,(c>>8&255)/255,(c&255)/255]}var e=e||{};e.Point=function(c,d){this.x=c||0;this.y=d||0};e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)};e.Point.prototype.constructor=e.Point;e.Rectangle=function(c,d,f,k){this.x=c||0;this.y=d||0;this.width=f||0;this.height=k||0};e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)};e.Rectangle.prototype.contains=
function(c,d){if(0>=this.width||0>=this.height)return!1;var f=this.x;return c>=f&&c<=f+this.width&&(f=this.y,d>=f&&d<=f+this.height)?!0:!1};e.Rectangle.prototype.constructor=e.Rectangle;e.Polygon=function(c){c instanceof Array||(c=Array.prototype.slice.call(arguments));if("number"===typeof c[0]){for(var d=[],f=0,k=c.length;f<k;f+=2)d.push(new e.Point(c[f],c[f+1]));c=d}this.points=c};e.Polygon.prototype.clone=function(){for(var c=[],d=0;d<this.points.length;d++)c.push(this.points[d].clone());return new e.Polygon(c)};
e.Polygon.prototype.contains=function(c,d){for(var f=!1,k=0,e=this.points.length-1;k<this.points.length;e=k++){var l=this.points[k].x,m=this.points[k].y,p=this.points[e].x,e=this.points[e].y;m>d!=e>d&&c<(p-l)*(d-m)/(e-m)+l&&(f=!f)}return f};e.Polygon.prototype.constructor=e.Polygon;e.Circle=function(c,d,f){this.x=c||0;this.y=d||0;this.radius=f||0};e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)};e.Circle.prototype.contains=function(c,d){if(0>=this.radius)return!1;
var f=this.x-c,k=this.y-d,e=this.radius*this.radius;return f*f+k*k<=e};e.Circle.prototype.constructor=e.Circle;e.Ellipse=function(c,d,f,k){this.x=c||0;this.y=d||0;this.width=f||0;this.height=k||0};e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)};e.Ellipse.prototype.contains=function(c,d){if(0>=this.width||0>=this.height)return!1;var f=(c-this.x)/this.width-0.5,k=(d-this.y)/this.height-0.5;return 0.25>f*f+k*k};e.Ellipse.getBounds=function(){return new e.Rectangle(this.x,
this.y,this.width,this.height)};e.Ellipse.prototype.constructor=e.Ellipse;e.Matrix="undefined"!==typeof Float32Array?Float32Array:Array;e.mat3={};e.mat3.create=function(){var c=new e.Matrix(9);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};e.mat3.identity=function(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=1;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};e.mat4={};e.mat4.create=function(){var c=new e.Matrix(16);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=
1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};e.mat3.multiply=function(c,d,f){f||(f=c);var k=c[0],e=c[1],l=c[2],m=c[3],p=c[4],v=c[5],t=c[6],q=c[7];c=c[8];var n=d[0],s=d[1],w=d[2],A=d[3],x=d[4],C=d[5],D=d[6],B=d[7];d=d[8];f[0]=n*k+s*m+w*t;f[1]=n*e+s*p+w*q;f[2]=n*l+s*v+w*c;f[3]=A*k+x*m+C*t;f[4]=A*e+x*p+C*q;f[5]=A*l+x*v+C*c;f[6]=D*k+B*m+d*t;f[7]=D*e+B*p+d*q;f[8]=D*l+B*v+d*c;return f};e.mat3.clone=function(c){var d=new e.Matrix(9);d[0]=c[0];d[1]=c[1];d[2]=c[2];d[3]=c[3];d[4]=c[4];d[5]=c[5];d[6]=
c[6];d[7]=c[7];d[8]=c[8];return d};e.mat3.transpose=function(c,d){if(!d||c===d){var f=c[1],k=c[2],e=c[5];c[1]=c[3];c[2]=c[6];c[3]=f;c[5]=c[7];c[6]=k;c[7]=e;return c}d[0]=c[0];d[1]=c[3];d[2]=c[6];d[3]=c[1];d[4]=c[4];d[5]=c[7];d[6]=c[2];d[7]=c[5];d[8]=c[8];return d};e.mat3.toMat4=function(c,d){d||(d=e.mat4.create());d[15]=1;d[14]=0;d[13]=0;d[12]=0;d[11]=0;d[10]=c[8];d[9]=c[7];d[8]=c[6];d[7]=0;d[6]=c[5];d[5]=c[4];d[4]=c[3];d[3]=0;d[2]=c[2];d[1]=c[1];d[0]=c[0];return d};e.mat4.create=function(){var c=
new e.Matrix(16);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};e.mat4.transpose=function(c,d){if(!d||c===d){var f=c[1],k=c[2],e=c[3],l=c[6],m=c[7],p=c[11];c[1]=c[4];c[2]=c[8];c[3]=c[12];c[4]=f;c[6]=c[9];c[7]=c[13];c[8]=k;c[9]=l;c[11]=c[14];c[12]=e;c[13]=m;c[14]=p;return c}d[0]=c[0];d[1]=c[4];d[2]=c[8];d[3]=c[12];d[4]=c[1];d[5]=c[5];d[6]=c[9];d[7]=c[13];d[8]=c[2];d[9]=c[6];d[10]=c[10];d[11]=c[14];d[12]=c[3];d[13]=c[7];
d[14]=c[11];d[15]=c[15];return d};e.mat4.multiply=function(c,d,f){f||(f=c);var k=c[0],e=c[1],l=c[2],m=c[3],p=c[4],v=c[5],t=c[6],q=c[7],n=c[8],s=c[9],w=c[10],A=c[11],x=c[12],C=c[13],D=c[14];c=c[15];var B=d[0],y=d[1],z=d[2],E=d[3];f[0]=B*k+y*p+z*n+E*x;f[1]=B*e+y*v+z*s+E*C;f[2]=B*l+y*t+z*w+E*D;f[3]=B*m+y*q+z*A+E*c;B=d[4];y=d[5];z=d[6];E=d[7];f[4]=B*k+y*p+z*n+E*x;f[5]=B*e+y*v+z*s+E*C;f[6]=B*l+y*t+z*w+E*D;f[7]=B*m+y*q+z*A+E*c;B=d[8];y=d[9];z=d[10];E=d[11];f[8]=B*k+y*p+z*n+E*x;f[9]=B*e+y*v+z*s+E*C;f[10]=
B*l+y*t+z*w+E*D;f[11]=B*m+y*q+z*A+E*c;B=d[12];y=d[13];z=d[14];E=d[15];f[12]=B*k+y*p+z*n+E*x;f[13]=B*e+y*v+z*s+E*C;f[14]=B*l+y*t+z*w+E*D;f[15]=B*m+y*q+z*A+E*c;return f};e.DisplayObject=function(){this.last=this;this.first=this;this.position=new e.Point;this.scale=new e.Point(1,1);this.pivot=new e.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.worldVisible=this.renderable=this.buttonMode=!1;this.stage=this.parent=null;this.worldAlpha=1;this._interactive=!1;this.worldTransform=
e.mat3.create();this.localTransform=e.mat3.create();this.color=[];this.dynamic=!0;this._sr=0;this._cr=1};e.DisplayObject.prototype.constructor=e.DisplayObject;e.DisplayObject.prototype.setInteractive=function(c){this.interactive=c};Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(c){this._interactive=c;this.stage&&(this.stage.dirty=!0)}});Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(c){(this._mask=
c)?this.addFilter(c):this.removeFilter()}});e.DisplayObject.prototype.addFilter=function(c){if(!this.filter){this.filter=!0;var d=new e.FilterBlock,f=new e.FilterBlock;d.mask=c;f.mask=c;d.first=d.last=this;f.first=f.last=this;d.open=!0;var k=d,h=d,l,m;(m=this.first._iPrev)?(l=m._iNext,k._iPrev=m,m._iNext=k):l=this;l&&(l._iPrev=h,h._iNext=l);h=k=f;m=this.last;if(l=m._iNext)l._iPrev=h,h._iNext=l;k._iPrev=m;m._iNext=k;k=this;for(h=this.last;k;)k.last==h&&(k.last=f),k=k.parent;this.first=d;this.__renderGroup&&
this.__renderGroup.addFilterBlocks(d,f);c.renderable=!1}};e.DisplayObject.prototype.removeFilter=function(){if(this.filter){this.filter=!1;var c=this.first,d=c._iNext,f=c._iPrev;d&&(d._iPrev=f);f&&(f._iNext=d);this.first=c._iNext;var k=this.last,d=k._iNext,f=k._iPrev;d&&(d._iPrev=f);f._iNext=d;d=k._iPrev;for(f=this;f.last==k&&(f.last=d,f=f.parent,f););c.mask.renderable=!0;this.__renderGroup&&this.__renderGroup.removeFilterBlocks(c,k)}};e.DisplayObject.prototype.updateTransform=function(){this.rotation!=
this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var c=this.localTransform,d=this.parent.worldTransform,f=this.worldTransform;c[0]=this._cr*this.scale.x;c[1]=-this._sr*this.scale.y;c[3]=this._sr*this.scale.x;c[4]=this._cr*this.scale.y;var k=this.pivot.x,e=this.pivot.y,l=c[0],m=c[1],p=this.position.x-c[0]*k-e*c[1],v=c[3],n=c[4],k=this.position.y-c[4]*e-k*c[3],e=d[0],q=d[1],u=d[2],s=d[3],w=d[4],d=d[5];c[2]=p;c[5]=k;f[0]=e*l+q*v;
f[1]=e*m+q*n;f[2]=e*p+q*k+u;f[3]=s*l+w*v;f[4]=s*m+w*n;f[5]=s*p+w*k+d;this.worldAlpha=this.alpha*this.parent.worldAlpha};e.DisplayObjectContainer=function(){e.DisplayObject.call(this);this.children=[]};e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype);e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer;e.DisplayObjectContainer.prototype.addChild=function(c){void 0!=c.parent&&c.parent.removeChild(c);c.parent=this;this.children.push(c);if(this.stage){var d=
c;do d.interactive&&(this.stage.dirty=!0),d.stage=this.stage,d=d._iNext;while(d)}var d=c.first,f=c.last,k,e;e=this.filter?this.last._iPrev:this.last;k=e._iNext;for(var l=this;l;)l.last==e&&(l.last=c.last),l=l.parent;k&&(k._iPrev=f,f._iNext=k);d._iPrev=e;e._iNext=d;this.__renderGroup&&(c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c),this.__renderGroup.addDisplayObjectAndChildren(c))};e.DisplayObjectContainer.prototype.addChildAt=function(c,d){if(0<=d&&d<=this.children.length){void 0!=
c.parent&&c.parent.removeChild(c);c.parent=this;if(this.stage){var f=c;do f.interactive&&(this.stage.dirty=!0),f.stage=this.stage,f=f._iNext;while(f)}var f=c.first,k=c.last,e,l;if(d==this.children.length){l=this.last;e=this;for(var m=this.last;e;)e.last==m&&(e.last=c.last),e=e.parent}else l=0==d?this:this.children[d-1].last;if(e=l._iNext)e._iPrev=k,k._iNext=e;f._iPrev=l;l._iNext=f;this.children.splice(d,0,c);this.__renderGroup&&(c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c),this.__renderGroup.addDisplayObjectAndChildren(c))}else throw Error(c+
" The index "+d+" supplied is out of bounds "+this.children.length);};e.DisplayObjectContainer.prototype.swapChildren=function(c,d){};e.DisplayObjectContainer.prototype.getChildAt=function(c){if(0<=c&&c<this.children.length)return this.children[c];throw Error(child+" Both the supplied DisplayObjects must be a child of the caller "+this);};e.DisplayObjectContainer.prototype.removeChild=function(c){var d=this.children.indexOf(c);if(-1!==d){var f=c.first,k=c.last,e=k._iNext,l=f._iPrev;e&&(e._iPrev=l);
l._iNext=e;if(this.last==k)for(e=f._iPrev,l=this;l.last==k.last&&(l.last=e,l=l.parent,l););k._iNext=null;f._iPrev=null;if(this.stage){f=c;do f.interactive&&(this.stage.dirty=!0),f.stage=null,f=f._iNext;while(f)}c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c);c.parent=void 0;this.children.splice(d,1)}else throw Error(c+" The supplied DisplayObject must be a child of the caller "+this);};e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){e.DisplayObject.prototype.updateTransform.call(this);
for(var c=0,d=this.children.length;c<d;c++)this.children[c].updateTransform()}};e.blendModes={};e.blendModes.NORMAL=0;e.blendModes.SCREEN=1;e.Sprite=function(c){e.DisplayObjectContainer.call(this);this.anchor=new e.Point;this.texture=c;this.blendMode=e.blendModes.NORMAL;this._height=this._width=0;c.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind));this.renderable=!0};e.Sprite.prototype=
Object.create(e.DisplayObjectContainer.prototype);e.Sprite.prototype.constructor=e.Sprite;Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(c){this.scale.x=c/this.texture.frame.width;this._width=c}});Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(c){this.scale.y=c/this.texture.frame.height;this._height=c}});e.Sprite.prototype.setTexture=function(c){this.texture.baseTexture!=
c.baseTexture&&(this.textureChange=!0);this.texture=c;this.updateFrame=!0};e.Sprite.prototype.onTextureUpdate=function(c){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=this._height/this.texture.frame.height);this.updateFrame=!0};e.Sprite.fromFrame=function(c){var d=e.TextureCache[c];if(!d)throw Error("The frameId '"+c+"' does not exist in the texture cache"+this);return new e.Sprite(d)};e.Sprite.fromImage=function(c){c=e.Texture.fromImage(c);return new e.Sprite(c)};
e.MovieClip=function(c){e.Sprite.call(this,c[0]);this.textures=c;this.animationSpeed=1;this.loop=!0;this.onComplete=null;this.currentFrame=0;this.playing=!1};e.MovieClip.prototype=Object.create(e.Sprite.prototype);e.MovieClip.prototype.constructor=e.MovieClip;e.MovieClip.prototype.stop=function(){this.playing=!1};e.MovieClip.prototype.play=function(){this.playing=!0};e.MovieClip.prototype.gotoAndStop=function(c){this.playing=!1;this.currentFrame=c;this.setTexture(this.textures[(this.currentFrame+
0.5|0)%this.textures.length])};e.MovieClip.prototype.gotoAndPlay=function(c){this.currentFrame=c;this.playing=!0};e.MovieClip.prototype.updateTransform=function(){e.Sprite.prototype.updateTransform.call(this);if(this.playing){this.currentFrame+=this.animationSpeed;var c=this.currentFrame+0.5|0;if(this.loop||c<this.textures.length)this.setTexture(this.textures[c%this.textures.length]);else if(c>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete))this.onComplete()}};e.FilterBlock=
function(c){this.graphics=c;this.renderable=this.visible=!0};e.Text=function(c,d){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");e.Sprite.call(this,e.Texture.fromCanvas(this.canvas));this.setStyle(d);this.setText(c);this.updateText();this.dirty=!1};e.Text.prototype=Object.create(e.Sprite.prototype);e.Text.prototype.constructor=e.Text;e.Text.prototype.setStyle=function(c){c=c||{};c.font=c.font||"bold 20pt Arial";c.fill=c.fill||"black";c.align=c.align||"left";
c.stroke=c.stroke||"black";c.strokeThickness=c.strokeThickness||0;c.wordWrap=c.wordWrap||!1;c.wordWrapWidth=c.wordWrapWidth||100;this.style=c;this.dirty=!0};e.Sprite.prototype.setText=function(c){this.text=c.toString()||" ";this.dirty=!0};e.Text.prototype.updateText=function(){this.context.font=this.style.font;var c=this.text;this.style.wordWrap&&(c=this.wordWrap(this.text));for(var c=c.split(/(?:\r\n|\r|\n)/),d=[],f=0,k=0;k<c.length;k++){var h=this.context.measureText(c[k]).width;d[k]=h;f=Math.max(f,
h)}this.canvas.width=f+this.style.strokeThickness;h=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;this.canvas.height=h*c.length;this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.lineWidth=this.style.strokeThickness;this.context.textBaseline="top";for(k=0;k<c.length;k++){var l=new e.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+k*h);"right"==this.style.align?l.x+=f-d[k]:
"center"==this.style.align&&(l.x+=(f-d[k])/2);this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(c[k],l.x,l.y);this.style.fill&&this.context.fillText(c[k],l.x,l.y)}this.updateTexture()};e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width;this.texture.baseTexture.height=this.canvas.height;this.texture.frame.width=this.canvas.width;this.texture.frame.height=this.canvas.height;this._width=this.canvas.width;this._height=this.canvas.height;e.texturesToUpdate.push(this.texture.baseTexture)};
e.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1);e.Sprite.prototype.updateTransform.call(this)};e.Text.prototype.determineFontHeight=function(c){var d=e.Text.heightCache[c];if(!d){var f=document.getElementsByTagName("body")[0],k=document.createElement("div"),d=document.createTextNode("M");k.appendChild(d);k.setAttribute("style",c+";position:absolute;top:0;left:0");f.appendChild(k);d=k.offsetHeight;e.Text.heightCache[c]=d;f.removeChild(k)}return d};e.Text.prototype.wordWrap=
function(c){var d=function(c,d,f,e,k){var h=Math.floor((e-f)/2)+f;if(h==f)return 1;if(c.measureText(d.substring(0,h)).width<=k){if(c.measureText(d.substring(0,h+1)).width>k){if(" "!=d.substring(h-1,h)&&" "!=d.substring(h,h+1)){do h--;while(0<h&&" "!=d.substring(h,h+1))}return h}return arguments.callee(c,d,h,e,k)}return arguments.callee(c,d,f,h,k)},f=function(c,f,e){if(c.measureText(f).width<=e||1>f.length)return f;var k=d(c,f,0,f.length,e),h=f.substring(0,k)+"\n";" "==f.substring(k,k+1)&&k++;return h+
arguments.callee(c,f.substring(k),e)},e="";c=c.split("\n");for(var h=0;h<c.length;h++)0<h&&(e+="\n"),e+=f(this.context,c[h],this.style.wordWrapWidth);return e};e.Text.prototype.destroy=function(c){c&&this.texture.destroy()};e.Text.heightCache={};e.BitmapText=function(c,d){e.DisplayObjectContainer.call(this);this.setText(c);this.setStyle(d);this.updateText();this.dirty=!1};e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype);e.BitmapText.prototype.constructor=e.BitmapText;e.BitmapText.prototype.setText=
function(c){this.text=c||" ";this.dirty=!0};e.BitmapText.prototype.setStyle=function(c){c=c||{};c.align=c.align||"left";this.style=c;c=c.font.split(" ");this.fontName=c[c.length-1];this.fontSize=2<=c.length?parseInt(c[c.length-2],10):e.BitmapText.fonts[this.fontName].size;this.dirty=!0};e.BitmapText.prototype.updateText=function(){for(var c=e.BitmapText.fonts[this.fontName],d=new e.Point,f=null,k=[],h=0,l=[],m=0,p=this.fontSize/c.size,v=0;v<this.text.length;v++){var n=this.text.charCodeAt(v);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(v)))l.push(d.x),
h=Math.max(h,d.x),m++,d.x=0,d.y+=c.lineHeight,f=null;else{var q=c.chars[n];q&&(f&&q[f]&&(d.x+=q.kerning[f]),k.push({texture:q.texture,line:m,charCode:n,position:new e.Point(d.x+q.xOffset,d.y+q.yOffset)}),d.x+=q.xAdvance,f=n)}}l.push(d.x);h=Math.max(h,d.x);f=[];for(v=0;v<=m;v++)n=0,"right"==this.style.align?n=h-l[v]:"center"==this.style.align&&(n=(h-l[v])/2),f.push(n);for(v=0;v<k.length;v++)h=new e.Sprite(k[v].texture),h.position.x=(k[v].position.x+f[k[v].line])*p,h.position.y=k[v].position.y*p,h.scale.x=
h.scale.y=p,this.addChild(h);this.width=d.x*p;this.height=(d.y+c.lineHeight)*p};e.BitmapText.prototype.updateTransform=function(){if(this.dirty){for(;0<this.children.length;)this.removeChild(this.getChildAt(0));this.updateText();this.dirty=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)};e.BitmapText.fonts={};e.InteractionManager=function(c){this.stage=c;this.mouse=new e.InteractionData;this.touchs={};this.tempPoint=new e.Point;this.mouseoverEnabled=!0;this.pool=[];this.interactiveItems=
[];this.last=0};e.InteractionManager.prototype.constructor=e.InteractionManager;e.InteractionManager.prototype.collectInteractiveSprite=function(c,d){for(var f=c.children,e=f.length-1;0<=e;e--){var h=f[e];h.visible&&(h.interactive?(d.interactiveChildren=!0,this.interactiveItems.push(h),0<h.children.length&&this.collectInteractiveSprite(h,h)):(h.__iParent=null,0<h.children.length&&this.collectInteractiveSprite(h,d)))}};e.InteractionManager.prototype.setTarget=function(c){window.navigator.msPointerEnabled&&
(c.view.style["-ms-content-zooming"]="none",c.view.style["-ms-touch-action"]="none");this.target=c;c.view.addEventListener("mousemove",this.onMouseMove.bind(this),!0);c.view.addEventListener("mousedown",this.onMouseDown.bind(this),!0);document.body.addEventListener("mouseup",this.onMouseUp.bind(this),!0);c.view.addEventListener("mouseout",this.onMouseUp.bind(this),!0);c.view.addEventListener("touchstart",this.onTouchStart.bind(this),!0);c.view.addEventListener("touchend",this.onTouchEnd.bind(this),
!0);c.view.addEventListener("touchmove",this.onTouchMove.bind(this),!0)};e.InteractionManager.prototype.update=function(){if(this.target){var c=Date.now(),d=c-this.last;if(!(1>30*d/1E3)){this.last=c;if(this.dirty){this.dirty=!1;d=this.interactiveItems.length;for(c=0;c<d;c++)this.interactiveItems[c].interactiveChildren=!1;this.interactiveItems=[];this.stage.interactive&&this.interactiveItems.push(this.stage);this.collectInteractiveSprite(this.stage,this.stage)}d=this.interactiveItems.length;this.target.view.style.cursor=
"default";for(c=0;c<d;c++){var f=this.interactiveItems[c];f.visible&&(f.mouseover||f.mouseout||f.buttonMode)&&(f.__hit=this.hitTest(f,this.mouse),this.mouse.target=f,f.__hit?(f.buttonMode&&(this.target.view.style.cursor="pointer"),f.__isOver||(f.mouseover&&f.mouseover(this.mouse),f.__isOver=!0)):f.__isOver&&(f.mouseout&&f.mouseout(this.mouse),f.__isOver=!1))}}}};e.InteractionManager.prototype.onMouseMove=function(c){this.mouse.originalEvent=c||window.event;var d=this.target.view.getBoundingClientRect();
this.mouse.global.x=(c.clientX-d.left)*(this.target.width/d.width);this.mouse.global.y=(c.clientY-d.top)*(this.target.height/d.height);c=this.interactiveItems.length;for(d=0;d<c;d++){var f=this.interactiveItems[d];f.mousemove&&f.mousemove(this.mouse)}};e.InteractionManager.prototype.onMouseDown=function(c){c.preventDefault();this.mouse.originalEvent=c||window.event;c=this.interactiveItems.length;for(var d=0;d<c;d++){var f=this.interactiveItems[d];if(f.mousedown||f.click)if(f.__mouseIsDown=!0,f.__hit=
this.hitTest(f,this.mouse),f.__hit&&(f.mousedown&&f.mousedown(this.mouse),f.__isDown=!0,!f.interactiveChildren))break}};e.InteractionManager.prototype.onMouseUp=function(c){this.mouse.originalEvent=c||window.event;c=this.interactiveItems.length;for(var d=!1,f=0;f<c;f++){var e=this.interactiveItems[f];if(e.mouseup||e.mouseupoutside||e.click)e.__hit=this.hitTest(e,this.mouse),e.__hit&&!d?(e.mouseup&&e.mouseup(this.mouse),e.__isDown&&e.click&&e.click(this.mouse),e.interactiveChildren||(d=!0)):e.__isDown&&
e.mouseupoutside&&e.mouseupoutside(this.mouse),e.__isDown=!1}};e.InteractionManager.prototype.hitTest=function(c,d){var f=d.global;if(!c.visible)return!1;var k=c instanceof e.Sprite,h=c.worldTransform,l=h[0],m=h[1],p=h[2],v=h[3],n=h[4],h=h[5],q=1/(l*n+m*-v),m=n*q*f.x+-m*q*f.y+(h*m-p*n)*q,f=l*q*f.y+-v*q*f.x+(-h*l+p*v)*q;d.target=c;if(c.hitArea&&c.hitArea.contains)return c.hitArea.contains(m,f)?(d.target=c,!0):!1;if(k&&(l=c.texture.frame.width,k=c.texture.frame.height,p=-l*c.anchor.x,m>p&&m<p+l&&(m=
-k*c.anchor.y,f>m&&f<m+k)))return d.target=c,!0;k=c.children.length;for(m=0;m<k;m++)if(this.hitTest(c.children[m],d))return d.target=c,!0;return!1};e.InteractionManager.prototype.onTouchMove=function(c){this.mouse.originalEvent=c||window.event;var d=this.target.view.getBoundingClientRect(),f=c.changedTouches;for(c=0;c<f.length;c++){var e=f[c],h=this.touchs[e.identifier];h.global.x=(e.clientX-d.left)*(this.target.width/d.width);h.global.y=(e.clientY-d.top)*(this.target.height/d.height)}d=this.interactiveItems.length;
for(c=0;c<d;c++)f=this.interactiveItems[c],f.touchmove&&f.touchmove(h)};e.InteractionManager.prototype.onTouchStart=function(c){c.preventDefault();this.mouse.originalEvent=c||window.event;var d=this.target.view.getBoundingClientRect();c=c.changedTouches;for(var f=0;f<c.length;f++){var k=c[f],h=this.pool.pop();h||(h=new e.InteractionData);this.touchs[k.identifier]=h;h.global.x=(k.clientX-d.left)*(this.target.width/d.width);h.global.y=(k.clientY-d.top)*(this.target.height/d.height);for(var k=this.interactiveItems.length,
l=0;l<k;l++){var m=this.interactiveItems[l];if(m.touchstart||m.tap)if(m.__hit=this.hitTest(m,h),m.__hit&&(m.touchstart&&m.touchstart(h),m.__isDown=!0,m.__touchData=h,!m.interactiveChildren))break}}};e.InteractionManager.prototype.onTouchEnd=function(c){this.mouse.originalEvent=c||window.event;var d=this.target.view.getBoundingClientRect();c=c.changedTouches;for(var f=0;f<c.length;f++){var e=c[f],h=this.touchs[e.identifier],l=!1;h.global.x=(e.clientX-d.left)*(this.target.width/d.width);h.global.y=
(e.clientY-d.top)*(this.target.height/d.height);for(var m=this.interactiveItems.length,p=0;p<m;p++){var v=this.interactiveItems[p],n=v.__touchData;v.__hit=this.hitTest(v,h);if(n==h){if(v.touchend||v.tap)v.__hit&&!l?(v.touchend&&v.touchend(h),v.__isDown&&v.tap&&v.tap(h),v.interactiveChildren||(l=!0)):v.__isDown&&v.touchendoutside&&v.touchendoutside(h),v.__isDown=!1;v.__touchData=null}}this.pool.push(h);this.touchs[e.identifier]=null}};e.InteractionData=function(){this.global=new e.Point;this.local=
new e.Point};e.InteractionData.prototype.getLocalPosition=function(c){var d=c.worldTransform;c=this.global;var f=d[0],k=d[1],h=d[2],l=d[3],m=d[4],d=d[5],p=1/(f*m+k*-l);return new e.Point(m*p*c.x+-k*p*c.y+(d*k-h*m)*p,f*p*c.y+-l*p*c.x+(-d*f+h*l)*p)};e.InteractionData.prototype.constructor=e.InteractionData;e.Stage=function(c,d){e.DisplayObjectContainer.call(this);this.worldTransform=e.mat3.create();this.interactive=d;this.interactionManager=new e.InteractionManager(this);this.dirty=!0;this.__childrenAdded=
[];this.__childrenRemoved=[];this.stage=this;this.stage.hitArea=new e.Rectangle(0,0,1E5,1E5);this.setBackgroundColor(c);this.worldVisible=!0};e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype);e.Stage.prototype.constructor=e.Stage;e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var c=0,d=this.children.length;c<d;c++)this.children[c].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0);this.interactive&&this.interactionManager.update()};
e.Stage.prototype.setBackgroundColor=function(c){this.backgroundColor=c||0;this.backgroundColorSplit=K(this.backgroundColor);c=this.backgroundColor.toString(16);c="000000".substr(0,6-c.length)+c;this.backgroundColorString="#"+c};e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var L=0,J=["ms","moz","webkit","o"],I=0;I<J.length&&!window.requestAnimationFrame;++I)window.requestAnimationFrame=window[J[I]+"RequestAnimationFrame"],window.cancelAnimationFrame=
window[J[I]+"CancelAnimationFrame"]||window[J[I]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c,d){var f=(new Date).getTime(),e=Math.max(0,16-(f-L)),h=window.setTimeout(function(){c(f+e)},e);L=f+e;return h});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(c){clearTimeout(c)});window.requestAnimFrame=window.requestAnimationFrame;"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var c=Array.prototype.slice;
return function(d){function f(){var l=h.concat(c.call(arguments));e.apply(this instanceof f?this:d,l)}var e=this,h=c.call(arguments,1);if("function"!=typeof e)throw new TypeError;f.prototype=function m(c){c&&(m.prototype=c);if(!(this instanceof m))return new m}(e.prototype);return f}}());var M=e.AjaxRequest=function(){var c=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(window.ActiveXObject)for(var d=0;d<c.length;d++)try{return new ActiveXObject(c[d])}catch(f){}else return window.XMLHttpRequest?new XMLHttpRequest:
!1};e.runList=function(c){console.log(">>>>>>>>>");console.log("_");var d=0;c=c.first;for(console.log(c);c._iNext;)if(d++,c=c._iNext,console.log(c),100<d){console.log("BREAK");break}};e.EventTarget=function(){var c={};this.addEventListener=this.on=function(d,f){void 0===c[d]&&(c[d]=[]);-1===c[d].indexOf(f)&&c[d].push(f)};this.dispatchEvent=this.emit=function(d){for(var f in c[d.type])c[d.type][f](d)};this.removeEventListener=this.off=function(d,f){var e=c[d].indexOf(f);-1!==e&&c[d].splice(e,1)}};
e.autoDetectRenderer=function(c,d,f,k){c||(c=800);d||(d=600);var h;try{h=!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(l){h=!1}return h?new e.WebGLRenderer(c,d,f,k):new e.CanvasRenderer(c,d,f,k)};e.PolyK={};e.PolyK.Triangulate=function(c){var d=!0,f=c.length>>1;if(3>f)return[];for(var k=[],h=[],l=0;l<f;l++)h.push(l);for(var l=0,m=f;3<m;){var p=h[(l+0)%m],v=h[(l+1)%m],n=h[(l+2)%m],q=c[2*p],u=c[2*p+1],s=c[2*v],w=c[2*v+1],A=c[2*n],x=c[2*n+1],
C=!1;if(e.PolyK._convex(q,u,s,w,A,x,d))for(var C=!0,D=0;D<m;D++){var B=h[D];if(B!=p&&(B!=v&&B!=n)&&e.PolyK._PointInTriangle(c[2*B],c[2*B+1],q,u,s,w,A,x)){C=!1;break}}if(C)k.push(p,v,n),h.splice((l+1)%m,1),m--,l=0;else if(l++>3*m)if(d){k=[];h=[];for(l=0;l<f;l++)h.push(l);l=0;m=f;d=!1}else return console.log("PIXI Warning: shape too complex to fill"),[]}k.push(h[0],h[1],h[2]);return k};e.PolyK._PointInTriangle=function(c,d,f,e,h,l,m,p){m-=f;p-=e;h-=f;l-=e;c-=f;f=d-e;d=m*m+p*p;e=m*h+p*l;m=m*c+p*f;p=
h*h+l*l;h=h*c+l*f;l=1/(d*p-e*e);p=(p*m-e*h)*l;m=(d*h-e*m)*l;return 0<=p&&0<=m&&1>p+m};e.PolyK._convex=function(c,d,f,e,h,l,m){return 0<=(d-e)*(h-f)+(f-c)*(l-e)==m};e.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"];e.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;",
"attribute float aColor;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = vec4( aVertexPosition.x / projectionVector.x -1.0, aVertexPosition.y / -projectionVector.y + 1.0 , 0.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"];e.stripShaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));",
"gl_FragColor = gl_FragColor * alpha;","}"];e.stripShaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;",
"}"];e.primitiveShaderFragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","gl_FragColor = vColor;","}"];e.primitiveShaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform float alpha;","varying vec4 vColor;","void main(void) {","vec3 v = translationMatrix * vec3(aVertexPosition, 1.0);","gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);",
"vColor = aColor  * alpha;","}"];e.initPrimitiveShader=function(){var c=e.gl,d=e.compileProgram(e.primitiveShaderVertexSrc,e.primitiveShaderFragmentSrc);c.useProgram(d);d.vertexPositionAttribute=c.getAttribLocation(d,"aVertexPosition");d.colorAttribute=c.getAttribLocation(d,"aColor");d.projectionVector=c.getUniformLocation(d,"projectionVector");d.translationMatrix=c.getUniformLocation(d,"translationMatrix");d.alpha=c.getUniformLocation(d,"alpha");e.primitiveProgram=d};e.initDefaultShader=function(){var c=
this.gl,d=e.compileProgram(e.shaderVertexSrc,e.shaderFragmentSrc);c.useProgram(d);d.vertexPositionAttribute=c.getAttribLocation(d,"aVertexPosition");d.projectionVector=c.getUniformLocation(d,"projectionVector");d.textureCoordAttribute=c.getAttribLocation(d,"aTextureCoord");d.colorAttribute=c.getAttribLocation(d,"aColor");d.samplerUniform=c.getUniformLocation(d,"uSampler");e.shaderProgram=d};e.initDefaultStripShader=function(){var c=this.gl,d=e.compileProgram(e.stripShaderVertexSrc,e.stripShaderFragmentSrc);
c.useProgram(d);d.vertexPositionAttribute=c.getAttribLocation(d,"aVertexPosition");d.projectionVector=c.getUniformLocation(d,"projectionVector");d.textureCoordAttribute=c.getAttribLocation(d,"aTextureCoord");d.translationMatrix=c.getUniformLocation(d,"translationMatrix");d.alpha=c.getUniformLocation(d,"alpha");d.colorAttribute=c.getAttribLocation(d,"aColor");d.projectionVector=c.getUniformLocation(d,"projectionVector");d.samplerUniform=c.getUniformLocation(d,"uSampler");e.stripShaderProgram=d};e.CompileVertexShader=
function(c,d){return e._CompileShader(c,d,c.VERTEX_SHADER)};e.CompileFragmentShader=function(c,d){return e._CompileShader(c,d,c.FRAGMENT_SHADER)};e._CompileShader=function(c,d,f){d=d.join("\n");f=c.createShader(f);c.shaderSource(f,d);c.compileShader(f);return c.getShaderParameter(f,c.COMPILE_STATUS)?f:(alert(c.getShaderInfoLog(f)),null)};e.compileProgram=function(c,d){var f=e.gl,k=e.CompileFragmentShader(f,d),h=e.CompileVertexShader(f,c),l=f.createProgram();f.attachShader(l,h);f.attachShader(l,k);
f.linkProgram(l);f.getProgramParameter(l,f.LINK_STATUS)||alert("Could not initialise shaders");return l};e.activateDefaultShader=function(){var c=e.gl,d=e.shaderProgram;c.useProgram(d);c.enableVertexAttribArray(d.vertexPositionAttribute);c.enableVertexAttribArray(d.textureCoordAttribute);c.enableVertexAttribArray(d.colorAttribute)};e.activatePrimitiveShader=function(){var c=e.gl;c.disableVertexAttribArray(e.shaderProgram.textureCoordAttribute);c.disableVertexAttribArray(e.shaderProgram.colorAttribute);
c.useProgram(e.primitiveProgram);c.enableVertexAttribArray(e.primitiveProgram.vertexPositionAttribute);c.enableVertexAttribArray(e.primitiveProgram.colorAttribute)};e.WebGLGraphics=function(){};e.WebGLGraphics.renderGraphics=function(c,d){var f=e.gl;c._webGL||(c._webGL={points:[],indices:[],lastIndex:0,buffer:f.createBuffer(),indexBuffer:f.createBuffer()});c.dirty&&(c.dirty=!1,c.clearDirty&&(c.clearDirty=!1,c._webGL.lastIndex=0,c._webGL.points=[],c._webGL.indices=[]),e.WebGLGraphics.updateGraphics(c));
e.activatePrimitiveShader();var k=e.mat3.clone(c.worldTransform);e.mat3.transpose(k);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.uniformMatrix3fv(e.primitiveProgram.translationMatrix,!1,k);f.uniform2f(e.primitiveProgram.projectionVector,d.x,d.y);f.uniform1f(e.primitiveProgram.alpha,c.worldAlpha);f.bindBuffer(f.ARRAY_BUFFER,c._webGL.buffer);f.vertexAttribPointer(e.shaderProgram.vertexPositionAttribute,2,f.FLOAT,!1,0,0);f.vertexAttribPointer(e.primitiveProgram.vertexPositionAttribute,2,f.FLOAT,!1,24,
0);f.vertexAttribPointer(e.primitiveProgram.colorAttribute,4,f.FLOAT,!1,24,8);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c._webGL.indexBuffer);f.drawElements(f.TRIANGLE_STRIP,c._webGL.indices.length,f.UNSIGNED_SHORT,0);e.activateDefaultShader()};e.WebGLGraphics.updateGraphics=function(c){for(var d=c._webGL.lastIndex;d<c.graphicsData.length;d++){var f=c.graphicsData[d];f.type==e.Graphics.POLY?(f.fill&&3<f.points.length&&e.WebGLGraphics.buildPoly(f,c._webGL),0<f.lineWidth&&e.WebGLGraphics.buildLine(f,c._webGL)):
f.type==e.Graphics.RECT?e.WebGLGraphics.buildRectangle(f,c._webGL):f.type!=e.Graphics.CIRC&&f.type!=e.Graphics.ELIP||e.WebGLGraphics.buildCircle(f,c._webGL)}c._webGL.lastIndex=c.graphicsData.length;d=e.gl;c._webGL.glPoints=new Float32Array(c._webGL.points);d.bindBuffer(d.ARRAY_BUFFER,c._webGL.buffer);d.bufferData(d.ARRAY_BUFFER,c._webGL.glPoints,d.STATIC_DRAW);c._webGL.glIndicies=new Uint16Array(c._webGL.indices);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c._webGL.indexBuffer);d.bufferData(d.ELEMENT_ARRAY_BUFFER,
c._webGL.glIndicies,d.STATIC_DRAW)};e.WebGLGraphics.buildRectangle=function(c,d){var f=c.points,k=f[0],h=f[1],l=f[2],f=f[3];if(c.fill){var m=K(c.fillColor),p=c.fillAlpha,n=m[0]*p,t=m[1]*p,m=m[2]*p,q=d.points,u=d.indices,s=q.length/6;q.push(k,h);q.push(n,t,m,p);q.push(k+l,h);q.push(n,t,m,p);q.push(k,h+f);q.push(n,t,m,p);q.push(k+l,h+f);q.push(n,t,m,p);u.push(s,s,s+1,s+2,s+3,s+3)}c.lineWidth&&(c.points=[k,h,k+l,h,k+l,h+f,k,h+f,k,h],e.WebGLGraphics.buildLine(c,d))};e.WebGLGraphics.buildCircle=function(c,
d){var f=c.points,k=f[0],h=f[1],l=f[2],f=f[3],m=2*Math.PI/40;if(c.fill){var p=K(c.fillColor),n=c.fillAlpha,t=p[0]*n,q=p[1]*n,p=p[2]*n,u=d.points,s=d.indices,w=u.length/6;s.push(w);for(var A=0;41>A;A++)u.push(k,h,t,q,p,n),u.push(k+Math.sin(m*A)*l,h+Math.cos(m*A)*f,t,q,p,n),s.push(w++,w++);s.push(w-1)}if(c.lineWidth){c.points=[];for(A=0;41>A;A++)c.points.push(k+Math.sin(m*A)*l,h+Math.cos(m*A)*f);e.WebGLGraphics.buildLine(c,d)}};e.WebGLGraphics.buildLine=function(c,d){var f=c.points;if(0!=f.length){var k=
new e.Point(f[0],f[1]),h=new e.Point(f[f.length-2],f[f.length-1]);if(k.x==h.x&&k.y==h.y){f.pop();f.pop();var h=new e.Point(f[f.length-2],f[f.length-1]),l=h.x+0.5*(k.x-h.x),k=h.y+0.5*(k.y-h.y);f.unshift(l,k);f.push(l,k)}var l=d.points,k=d.indices,h=f.length/2,m=f.length,p=l.length/6,n=c.lineWidth/2,t=K(c.lineColor),q=c.lineAlpha,u=t[0]*q,s=t[1]*q,t=t[2]*q,w,A,x,C,D,B,y,z,E,G,F,I,J;w=f[0];A=f[1];x=f[2];C=f[3];y=-(A-C);z=w-x;F=Math.sqrt(y*y+z*z);y=y/F*n;z=z/F*n;l.push(w-y,A-z,u,s,t,q);l.push(w+y,A+z,
u,s,t,q);for(var H=1;H<h-1;H++)w=f[2*(H-1)],A=f[2*(H-1)+1],x=f[2*H],C=f[2*H+1],D=f[2*(H+1)],B=f[2*(H+1)+1],y=-(A-C),z=w-x,F=Math.sqrt(y*y+z*z),y/=F,z/=F,y*=n,z*=n,E=-(C-B),G=x-D,F=Math.sqrt(E*E+G*G),E/=F,G/=F,E*=n,G*=n,F=-z+A-(-z+C),I=-y+x-(-y+w),w=(-y+w)*(-z+C)-(-y+x)*(-z+A),A=-G+B-(-G+C),J=-E+x-(-E+D),D=(-E+D)*(-G+C)-(-E+x)*(-G+B),B=F*J-A*I,0==B&&(B+=1),px=(I*D-J*w)/B,py=(A*w-F*D)/B,F=(px-x)*(px-x)+(py-C)+(py-C),19600<F?(y-=E,z-=G,F=Math.sqrt(y*y+z*z),y/=F,z/=F,y*=n,z*=n,l.push(x-y,C-z),l.push(u,
s,t,q),l.push(x+y,C+z),l.push(u,s,t,q),l.push(x-y,C-z),l.push(u,s,t,q),m++):(l.push(px,py),l.push(u,s,t,q),l.push(x-(px-x),C-(py-C)),l.push(u,s,t,q));w=f[2*(h-2)];A=f[2*(h-2)+1];x=f[2*(h-1)];C=f[2*(h-1)+1];y=-(A-C);z=w-x;F=Math.sqrt(y*y+z*z);y/=F;z/=F;y*=n;z*=n;l.push(x-y,C-z);l.push(u,s,t,q);l.push(x+y,C+z);l.push(u,s,t,q);k.push(p);for(H=0;H<m;H++)k.push(p++);k.push(p-1)}};e.WebGLGraphics.buildPoly=function(c,d){var f=c.points;if(!(6>f.length)){for(var k=d.points,h=d.indices,l=f.length/2,m=K(c.fillColor),
p=c.fillAlpha,n=m[0]*p,t=m[1]*p,m=m[2]*p,q=e.PolyK.Triangulate(f),u=k.length/6,s=0;s<q.length;s+=3)h.push(q[s]+u),h.push(q[s]+u),h.push(q[s+1]+u),h.push(q[s+2]+u),h.push(q[s+2]+u);for(s=0;s<l;s++)k.push(f[2*s],f[2*s+1],n,t,m,p)}};e._defaultFrame=new e.Rectangle(0,0,1,1);e.gl;e.WebGLRenderer=function(c,d,f,k){this.transparent=!!k;this.width=c||800;this.height=d||600;this.view=f||document.createElement("canvas");this.view.width=this.width;this.view.height=this.height;var h=this;this.view.addEventListener("webglcontextlost",
function(c){h.handleContextLost(c)},!1);this.view.addEventListener("webglcontextrestored",function(c){h.handleContextRestored(c)},!1);this.batchs=[];try{e.gl=this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!0,premultipliedAlpha:!1,stencil:!0})}catch(l){throw Error(" This browser does not support webGL. Try using the canvas renderer"+this);}e.initPrimitiveShader();e.initDefaultShader();e.initDefaultStripShader();e.activateDefaultShader();c=this.gl;e.WebGLRenderer.gl=
c;this.batch=new e.WebGLBatch(c);c.disable(c.DEPTH_TEST);c.disable(c.CULL_FACE);c.enable(c.BLEND);c.colorMask(!0,!0,!0,this.transparent);e.projection=new e.Point(400,300);this.resize(this.width,this.height);this.contextLost=!1;this.stageRenderGroup=new e.WebGLRenderGroup(this.gl)};e.WebGLRenderer.prototype.constructor=e.WebGLRenderer;e.WebGLRenderer.getBatch=function(){return 0==e._batchs.length?new e.WebGLBatch(e.WebGLRenderer.gl):e._batchs.pop()};e.WebGLRenderer.returnBatch=function(c){c.clean();
e._batchs.push(c)};e.WebGLRenderer.prototype.render=function(c){if(!this.contextLost){this.__stage!==c&&(this.__stage=c,this.stageRenderGroup.setRenderable(c));e.WebGLRenderer.updateTextures();c.updateTransform();var d=this.gl;d.colorMask(!0,!0,!0,this.transparent);d.viewport(0,0,this.width,this.height);d.bindFramebuffer(d.FRAMEBUFFER,null);d.clearColor(c.backgroundColorSplit[0],c.backgroundColorSplit[1],c.backgroundColorSplit[2],!this.transparent);d.clear(d.COLOR_BUFFER_BIT);this.stageRenderGroup.backgroundColor=
c.backgroundColorSplit;this.stageRenderGroup.render(e.projection);c.interactive&&!c._interactiveEventsAdded&&(c._interactiveEventsAdded=!0,c.interactionManager.setTarget(this));if(0<e.Texture.frameUpdates.length){for(c=0;c<e.Texture.frameUpdates.length;c++)e.Texture.frameUpdates[c].updateFrame=!1;e.Texture.frameUpdates=[]}}};e.WebGLRenderer.updateTextures=function(){for(var c=0;c<e.texturesToUpdate.length;c++)e.WebGLRenderer.updateTexture(e.texturesToUpdate[c]);for(c=0;c<e.texturesToDestroy.length;c++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[c]);
e.texturesToUpdate=[];e.texturesToDestroy=[]};e.WebGLRenderer.updateTexture=function(c){var d=e.gl;c._glTexture||(c._glTexture=d.createTexture());c.hasLoaded&&(d.bindTexture(d.TEXTURE_2D,c._glTexture),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,c.source),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),c._powerOf2?(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),
d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT)):(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE)),d.bindTexture(d.TEXTURE_2D,null))};e.WebGLRenderer.destroyTexture=function(c){var d=e.gl;c._glTexture&&(c._glTexture=d.createTexture(),d.deleteTexture(d.TEXTURE_2D,c._glTexture))};e.WebGLRenderer.prototype.resize=function(c,d){this.width=c;this.height=d;this.view.width=c;this.view.height=d;this.gl.viewport(0,0,this.width,
this.height);e.projection.x=this.width/2;e.projection.y=this.height/2};e.WebGLRenderer.prototype.handleContextLost=function(c){c.preventDefault();this.contextLost=!0};e.WebGLRenderer.prototype.handleContextRestored=function(c){this.gl=this.view.getContext("experimental-webgl",{alpha:!0});this.initShaders();for(var d in e.TextureCache)c=e.TextureCache[d].baseTexture,c._glTexture=null,e.WebGLRenderer.updateTexture(c);for(d=0;d<this.batchs.length;d++)this.batchs[d].restoreLostContext(this.gl),this.batchs[d].dirty=
!0;e._restoreBatchs(this.gl);this.contextLost=!1};e._batchs=[];e._getBatch=function(c){return 0==e._batchs.length?new e.WebGLBatch(c):e._batchs.pop()};e._returnBatch=function(c){c.clean();e._batchs.push(c)};e._restoreBatchs=function(c){for(var d=0;d<e._batchs.length;d++)e._batchs[d].restoreLostContext(c)};e.WebGLBatch=function(c){this.gl=c;this.size=0;this.vertexBuffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.uvBuffer=c.createBuffer();this.colorBuffer=c.createBuffer();this.blendMode=
e.blendModes.NORMAL;this.dynamicSize=1};e.WebGLBatch.prototype.constructor=e.WebGLBatch;e.WebGLBatch.prototype.clean=function(){this.verticies=[];this.uvs=[];this.indices=[];this.colors=[];this.dynamicSize=1;this.last=this.texture=null;this.size=0;this.head;this.tail};e.WebGLBatch.prototype.restoreLostContext=function(c){this.gl=c;this.vertexBuffer=c.createBuffer();this.indexBuffer=c.createBuffer();this.uvBuffer=c.createBuffer();this.colorBuffer=c.createBuffer()};e.WebGLBatch.prototype.init=function(c){c.batch=
this;this.dirty=!0;this.blendMode=c.blendMode;this.texture=c.texture.baseTexture;this.tail=this.head=c;this.size=1;this.growBatch()};e.WebGLBatch.prototype.insertBefore=function(c,d){this.size++;c.batch=this;this.dirty=!0;var f=d.__prev;d.__prev=c;c.__next=d;f?(c.__prev=f,f.__next=c):this.head=c};e.WebGLBatch.prototype.insertAfter=function(c,d){this.size++;c.batch=this;this.dirty=!0;var f=d.__next;d.__next=c;c.__prev=d;f?(c.__next=f,f.__prev=c):this.tail=c};e.WebGLBatch.prototype.remove=function(c){this.size--;
0==this.size?(c.batch=null,c.__prev=null,c.__next=null):(c.__prev?c.__prev.__next=c.__next:(this.head=c.__next,this.head.__prev=null),c.__next?c.__next.__prev=c.__prev:(this.tail=c.__prev,this.tail.__next=null),c.batch=null,c.__next=null,c.__prev=null,this.dirty=!0)};e.WebGLBatch.prototype.split=function(c){this.dirty=!0;var d=new e.WebGLBatch(this.gl);d.init(c);d.texture=this.texture;d.tail=this.tail;this.tail=c.__prev;this.tail.__next=null;c.__prev=null;for(var f=0;c;)f++,c.batch=d,c=c.__next;d.size=
f;this.size-=f;return d};e.WebGLBatch.prototype.merge=function(c){this.dirty=!0;this.tail.__next=c.head;c.head.__prev=this.tail;this.size+=c.size;this.tail=c.tail;for(c=c.head;c;)c.batch=this,c=c.__next};e.WebGLBatch.prototype.growBatch=function(){var c=this.gl;this.dynamicSize=1==this.size?1:1.5*this.size;this.verticies=new Float32Array(8*this.dynamicSize);c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);c.bufferData(c.ARRAY_BUFFER,this.verticies,c.DYNAMIC_DRAW);this.uvs=new Float32Array(8*this.dynamicSize);
c.bindBuffer(c.ARRAY_BUFFER,this.uvBuffer);c.bufferData(c.ARRAY_BUFFER,this.uvs,c.DYNAMIC_DRAW);this.dirtyUVS=!0;this.colors=new Float32Array(4*this.dynamicSize);c.bindBuffer(c.ARRAY_BUFFER,this.colorBuffer);c.bufferData(c.ARRAY_BUFFER,this.colors,c.DYNAMIC_DRAW);this.dirtyColors=!0;this.indices=new Uint16Array(6*this.dynamicSize);for(var d=this.indices.length/6,f=0;f<d;f++){var e=6*f,h=4*f;this.indices[e+0]=h+0;this.indices[e+1]=h+1;this.indices[e+2]=h+2;this.indices[e+3]=h+0;this.indices[e+4]=h+
2;this.indices[e+5]=h+3}c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,this.indices,c.STATIC_DRAW)};e.WebGLBatch.prototype.refresh=function(){this.dynamicSize<this.size&&this.growBatch();for(var c=0,d,f=this.head;f;){d=8*c;var e=f.texture,h=e.frame,l=e.baseTexture.width,e=e.baseTexture.height;this.uvs[d+0]=h.x/l;this.uvs[d+1]=h.y/e;this.uvs[d+2]=(h.x+h.width)/l;this.uvs[d+3]=h.y/e;this.uvs[d+4]=(h.x+h.width)/l;this.uvs[d+5]=(h.y+h.height)/e;this.uvs[d+6]=
h.x/l;this.uvs[d+7]=(h.y+h.height)/e;f.updateFrame=!1;colorIndex=4*c;this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=f.worldAlpha;f=f.__next;c++}this.dirtyColors=this.dirtyUVS=!0};e.WebGLBatch.prototype.update=function(){for(var c,d,f,e,h,l,m,p,n,t,q,u=0,s=this.head;s;){if(s.worldVisible){d=s.texture.frame.width;f=s.texture.frame.height;e=s.anchor.x;h=s.anchor.y;l=d*(1-e);d*=-e;e=f*(1-h);h=f*-h;f=8*u;c=s.worldTransform;m=c[0];p=c[3];n=c[1];t=c[4];
q=c[2];c=c[5];this.verticies[f+0]=m*d+n*h+q;this.verticies[f+1]=t*h+p*d+c;this.verticies[f+2]=m*l+n*h+q;this.verticies[f+3]=t*h+p*l+c;this.verticies[f+4]=m*l+n*e+q;this.verticies[f+5]=t*e+p*l+c;this.verticies[f+6]=m*d+n*e+q;this.verticies[f+7]=t*e+p*d+c;if(s.updateFrame||s.texture.updateFrame)this.dirtyUVS=!0,e=s.texture,l=e.frame,d=e.baseTexture.width,e=e.baseTexture.height,this.uvs[f+0]=l.x/d,this.uvs[f+1]=l.y/e,this.uvs[f+2]=(l.x+l.width)/d,this.uvs[f+3]=l.y/e,this.uvs[f+4]=(l.x+l.width)/d,this.uvs[f+
5]=(l.y+l.height)/e,this.uvs[f+6]=l.x/d,this.uvs[f+7]=(l.y+l.height)/e,s.updateFrame=!1;s.cacheAlpha!=s.worldAlpha&&(s.cacheAlpha=s.worldAlpha,l=4*u,this.colors[l]=this.colors[l+1]=this.colors[l+2]=this.colors[l+3]=s.worldAlpha,this.dirtyColors=!0)}else f=8*u,this.verticies[f+0]=0,this.verticies[f+1]=0,this.verticies[f+2]=0,this.verticies[f+3]=0,this.verticies[f+4]=0,this.verticies[f+5]=0,this.verticies[f+6]=0,this.verticies[f+7]=0;u++;s=s.__next}};e.WebGLBatch.prototype.render=function(c,d){c=c||
0;void 0==d&&(d=this.size);this.dirty&&(this.refresh(),this.dirty=!1);if(0!=this.size){this.update();var f=this.gl,k=e.shaderProgram;f.useProgram(k);f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.bufferSubData(f.ARRAY_BUFFER,0,this.verticies);f.vertexAttribPointer(k.vertexPositionAttribute,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);this.dirtyUVS&&(this.dirtyUVS=!1,f.bufferSubData(f.ARRAY_BUFFER,0,this.uvs));f.vertexAttribPointer(k.textureCoordAttribute,2,f.FLOAT,!1,0,0);f.activeTexture(f.TEXTURE0);
f.bindTexture(f.TEXTURE_2D,this.texture._glTexture);f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer);this.dirtyColors&&(this.dirtyColors=!1,f.bufferSubData(f.ARRAY_BUFFER,0,this.colors));f.vertexAttribPointer(k.colorAttribute,1,f.FLOAT,!1,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.drawElements(f.TRIANGLES,6*(d-c),f.UNSIGNED_SHORT,12*c)}};e.WebGLRenderGroup=function(c){this.gl=c;this.root;this.backgroundColor;this.batchs=[];this.toRemove=[]};e.WebGLRenderGroup.prototype.constructor=
e.WebGLRenderGroup;e.WebGLRenderGroup.prototype.setRenderable=function(c){this.root&&this.removeDisplayObjectAndChildren(this.root);c.worldVisible=c.visible;this.root=c;this.addDisplayObjectAndChildren(c)};e.WebGLRenderGroup.prototype.render=function(c){e.WebGLRenderer.updateTextures();var d=this.gl;d.uniform2f(e.shaderProgram.projectionVector,c.x,c.y);d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA);this.checkVisibility(this.root,this.root.visible);for(var f,k=0;k<this.batchs.length;k++)f=this.batchs[k],
f instanceof e.WebGLBatch?this.batchs[k].render():f instanceof e.TilingSprite?f.worldVisible&&this.renderTilingSprite(f,c):f instanceof e.Strip?f.worldVisible&&this.renderStrip(f,c):f instanceof e.Graphics?f.worldVisible&&f.renderable&&e.WebGLGraphics.renderGraphics(f,c):f instanceof e.FilterBlock&&(f.open?(d.enable(d.STENCIL_TEST),d.colorMask(!1,!1,!1,!1),d.stencilFunc(d.ALWAYS,1,255),d.stencilOp(d.KEEP,d.KEEP,d.REPLACE),e.WebGLGraphics.renderGraphics(f.mask,c),d.colorMask(!0,!0,!0,!1),d.stencilFunc(d.NOTEQUAL,
0,255),d.stencilOp(d.KEEP,d.KEEP,d.KEEP)):d.disable(d.STENCIL_TEST))};e.WebGLRenderGroup.prototype.handleFilter=function(c,d){};e.WebGLRenderGroup.prototype.renderSpecific=function(c,d){e.WebGLRenderer.updateTextures();var f=this.gl;this.checkVisibility(c,c.visible);f.uniform2f(e.shaderProgram.projectionVector,d.x,d.y);for(var k,h,l,m,p=c.first;p._iNext&&(p=p._iNext,!p.renderable||!p.__renderGroup););f=p.batch;if(p instanceof e.Sprite)if(f=p.batch,m=f.head,m==p)k=0;else for(k=1;m.__next!=p;)k++,m=
m.__next;else f=p;for(p=h=c;0<p.children.length;)p=p.children[p.children.length-1],p.renderable&&(h=p);if(h instanceof e.Sprite)if(p=h.batch,m=p.head,m==h)l=0;else for(l=1;m.__next!=h;)l++,m=m.__next;else p=h;if(f==p)f instanceof e.WebGLBatch?f.render(k,l+1):this.renderSpecial(f,d);else{h=this.batchs.indexOf(f);m=this.batchs.indexOf(p);f instanceof e.WebGLBatch?f.render(k):this.renderSpecial(f,d);for(k=h+1;k<m;k++)renderable=this.batchs[k],renderable instanceof e.WebGLBatch?this.batchs[k].render():
this.renderSpecial(renderable,d);p instanceof e.WebGLBatch?p.render(0,l+1):this.renderSpecial(p,d)}};e.WebGLRenderGroup.prototype.renderSpecial=function(c,d){if(c instanceof e.TilingSprite)c.worldVisible&&this.renderTilingSprite(c,d);else if(c instanceof e.Strip)c.worldVisible&&this.renderStrip(c,d);else if(c instanceof e.CustomRenderable)c.worldVisible&&c.renderWebGL(this,d);else if(c instanceof e.Graphics)c.worldVisible&&c.renderable&&e.WebGLGraphics.renderGraphics(c,d);else if(c instanceof e.FilterBlock){var f=
e.gl;c.open?(f.enable(f.STENCIL_TEST),f.colorMask(!1,!1,!1,!1),f.stencilFunc(f.ALWAYS,1,255),f.stencilOp(f.KEEP,f.KEEP,f.REPLACE),e.WebGLGraphics.renderGraphics(c.mask,d),f.colorMask(!0,!0,!0,!0),f.stencilFunc(f.NOTEQUAL,0,255),f.stencilOp(f.KEEP,f.KEEP,f.KEEP)):f.disable(f.STENCIL_TEST)}};e.WebGLRenderGroup.prototype.checkVisibility=function(c,d){for(var f=c.children,e=0;e<f.length;e++){var h=f[e];h.worldVisible=h.visible&&d;h.textureChange&&(h.textureChange=!1,h.worldVisible&&this.updateTexture(h));
0<h.children.length&&this.checkVisibility(h,h.worldVisible)}};e.WebGLRenderGroup.prototype.updateTexture=function(c){this.removeObject(c);for(var d=c.first;d!=this.root&&(d=d._iPrev,!d.renderable||!d.__renderGroup););for(var f=c.last;f._iNext&&(f=f._iNext,!f.renderable||!f.__renderGroup););this.insertObject(c,d,f)};e.WebGLRenderGroup.prototype.addFilterBlocks=function(c,d){c.__renderGroup=this;d.__renderGroup=this;for(var f=c;f!=this.root&&(f=f._iPrev,!f.renderable||!f.__renderGroup););this.insertAfter(c,
f);for(f=d;f!=this.root&&(f=f._iPrev,!f.renderable||!f.__renderGroup););this.insertAfter(d,f)};e.WebGLRenderGroup.prototype.removeFilterBlocks=function(c,d){this.removeObject(c);this.removeObject(d)};e.WebGLRenderGroup.prototype.addDisplayObjectAndChildren=function(c){c.__renderGroup&&c.__renderGroup.removeDisplayObjectAndChildren(c);for(var d=c.first;d!=this.root.first&&(d=d._iPrev,!d.renderable||!d.__renderGroup););for(var f=c.last;f._iNext&&(f=f._iNext,!f.renderable||!f.__renderGroup););var e=
c.first;c=c.last._iNext;do e.__renderGroup=this,e.renderable&&(this.insertObject(e,d,f),d=e),e=e._iNext;while(e!=c)};e.WebGLRenderGroup.prototype.removeDisplayObjectAndChildren=function(c){if(c.__renderGroup==this){do c.__renderGroup=null,c.renderable&&this.removeObject(c),c=c._iNext;while(c)}};e.WebGLRenderGroup.prototype.insertObject=function(c,d,f){if(c instanceof e.Sprite){var k;if(d instanceof e.Sprite){if((k=d.batch)&&k.texture==c.texture.baseTexture&&k.blendMode==c.blendMode){k.insertAfter(c,
d);return}}else k=d;if(f&&f instanceof e.Sprite&&(d=f.batch)){if(d.texture==c.texture.baseTexture&&d.blendMode==c.blendMode){d.insertBefore(c,f);return}if(d==k){f=k.split(f);d=e.WebGLRenderer.getBatch();k=this.batchs.indexOf(k);d.init(c);this.batchs.splice(k+1,0,d,f);return}}d=e.WebGLRenderer.getBatch();d.init(c);k?(k=this.batchs.indexOf(k),this.batchs.splice(k+1,0,d)):this.batchs.push(d)}else c instanceof e.TilingSprite?this.initTilingSprite(c):c instanceof e.Strip&&this.initStrip(c),this.insertAfter(c,
d)};e.WebGLRenderGroup.prototype.insertAfter=function(c,d){if(d instanceof e.Sprite){var f=d.batch;if(f)if(f.tail==d)f=this.batchs.indexOf(f),this.batchs.splice(f+1,0,c);else{var k=f.split(d.__next),f=this.batchs.indexOf(f);this.batchs.splice(f+1,0,c,k)}else this.batchs.push(c)}else f=this.batchs.indexOf(d),this.batchs.splice(f+1,0,c)};e.WebGLRenderGroup.prototype.removeObject=function(c){var d;if(c instanceof e.Sprite){var f=c.batch;if(!f)return;f.remove(c);0==f.size&&(d=f)}else d=c;d&&(c=this.batchs.indexOf(d),
-1!=c&&(0!=c&&c!=this.batchs.length-1&&this.batchs[c-1]instanceof e.WebGLBatch&&this.batchs[c+1]instanceof e.WebGLBatch&&this.batchs[c-1].texture==this.batchs[c+1].texture&&this.batchs[c-1].blendMode==this.batchs[c+1].blendMode?(this.batchs[c-1].merge(this.batchs[c+1]),d instanceof e.WebGLBatch&&e.WebGLRenderer.returnBatch(d),e.WebGLRenderer.returnBatch(this.batchs[c+1]),this.batchs.splice(c,2)):(this.batchs.splice(c,1),d instanceof e.WebGLBatch&&e.WebGLRenderer.returnBatch(d))))};e.WebGLRenderGroup.prototype.initTilingSprite=
function(c){var d=this.gl;c.verticies=new Float32Array([0,0,c.width,0,c.width,c.height,0,c.height]);c.uvs=new Float32Array([0,0,1,0,1,1,0,1]);c.colors=new Float32Array([1,1,1,1]);c.indices=new Uint16Array([0,1,3,2]);c._vertexBuffer=d.createBuffer();c._indexBuffer=d.createBuffer();c._uvBuffer=d.createBuffer();c._colorBuffer=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,c._vertexBuffer);d.bufferData(d.ARRAY_BUFFER,c.verticies,d.STATIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,c._uvBuffer);d.bufferData(d.ARRAY_BUFFER,
c.uvs,d.DYNAMIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,c._colorBuffer);d.bufferData(d.ARRAY_BUFFER,c.colors,d.STATIC_DRAW);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c._indexBuffer);d.bufferData(d.ELEMENT_ARRAY_BUFFER,c.indices,d.STATIC_DRAW);c.texture.baseTexture._glTexture&&(d.bindTexture(d.TEXTURE_2D,c.texture.baseTexture._glTexture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT));c.texture.baseTexture._powerOf2=!0};e.WebGLRenderGroup.prototype.renderStrip=
function(c,d){var f=this.gl,k=e.shaderProgram;f.useProgram(e.stripShaderProgram);var h=e.mat3.clone(c.worldTransform);e.mat3.transpose(h);f.uniformMatrix3fv(e.stripShaderProgram.translationMatrix,!1,h);f.uniform2f(e.stripShaderProgram.projectionVector,d.x,d.y);f.uniform1f(e.stripShaderProgram.alpha,c.worldAlpha);c.dirty?(c.dirty=!1,f.bindBuffer(f.ARRAY_BUFFER,c._vertexBuffer),f.bufferData(f.ARRAY_BUFFER,c.verticies,f.STATIC_DRAW),f.vertexAttribPointer(k.vertexPositionAttribute,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,
c._uvBuffer),f.bufferData(f.ARRAY_BUFFER,c.uvs,f.STATIC_DRAW),f.vertexAttribPointer(k.textureCoordAttribute,2,f.FLOAT,!1,0,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,c.texture.baseTexture._glTexture),f.bindBuffer(f.ARRAY_BUFFER,c._colorBuffer),f.bufferData(f.ARRAY_BUFFER,c.colors,f.STATIC_DRAW),f.vertexAttribPointer(k.colorAttribute,1,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c._indexBuffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,c.indices,f.STATIC_DRAW)):(f.bindBuffer(f.ARRAY_BUFFER,
c._vertexBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,c.verticies),f.vertexAttribPointer(k.vertexPositionAttribute,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,c._uvBuffer),f.vertexAttribPointer(k.textureCoordAttribute,2,f.FLOAT,!1,0,0),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,c.texture.baseTexture._glTexture),f.bindBuffer(f.ARRAY_BUFFER,c._colorBuffer),f.vertexAttribPointer(k.colorAttribute,1,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c._indexBuffer));f.drawElements(f.TRIANGLE_STRIP,
c.indices.length,f.UNSIGNED_SHORT,0);f.useProgram(e.shaderProgram)};e.WebGLRenderGroup.prototype.renderTilingSprite=function(c,d){var f=this.gl,e=c.tilePosition,h=c.tileScale,l=e.x/c.texture.baseTexture.width,e=e.y/c.texture.baseTexture.height,m=c.width/c.texture.baseTexture.width/h.x,h=c.height/c.texture.baseTexture.height/h.y;c.uvs[0]=0-l;c.uvs[1]=0-e;c.uvs[2]=1*m-l;c.uvs[3]=0-e;c.uvs[4]=1*m-l;c.uvs[5]=1*h-e;c.uvs[6]=0-l;c.uvs[7]=1*h-e;f.bindBuffer(f.ARRAY_BUFFER,c._uvBuffer);f.bufferSubData(f.ARRAY_BUFFER,
0,c.uvs);this.renderStrip(c,d)};e.WebGLRenderGroup.prototype.initStrip=function(c){var d=this.gl;c._vertexBuffer=d.createBuffer();c._indexBuffer=d.createBuffer();c._uvBuffer=d.createBuffer();c._colorBuffer=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,c._vertexBuffer);d.bufferData(d.ARRAY_BUFFER,c.verticies,d.DYNAMIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,c._uvBuffer);d.bufferData(d.ARRAY_BUFFER,c.uvs,d.STATIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,c._colorBuffer);d.bufferData(d.ARRAY_BUFFER,c.colors,d.STATIC_DRAW);
d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c._indexBuffer);d.bufferData(d.ELEMENT_ARRAY_BUFFER,c.indices,d.STATIC_DRAW)};e.CanvasRenderer=function(c,d,f,e){this.transparent=e;this.width=c||800;this.height=d||600;this.view=f||document.createElement("canvas");this.context=this.view.getContext("2d");this.refresh=!0;this.view.width=this.width;this.view.height=this.height;this.count=0};e.CanvasRenderer.prototype.constructor=e.CanvasRenderer;e.CanvasRenderer.prototype.render=function(c){e.texturesToUpdate=[];
e.texturesToDestroy=[];c.updateTransform();this.view.style.backgroundColor==c.backgroundColorString||this.transparent||(this.view.style.backgroundColor=c.backgroundColorString);this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height);this.renderDisplayObject(c);c.interactive&&!c._interactiveEventsAdded&&(c._interactiveEventsAdded=!0,c.interactionManager.setTarget(this));0<e.Texture.frameUpdates.length&&(e.Texture.frameUpdates=[])};e.CanvasRenderer.prototype.resize=
function(c,d){this.width=c;this.height=d;this.view.width=c;this.view.height=d};e.CanvasRenderer.prototype.renderDisplayObject=function(c){var d,f=this.context;f.globalCompositeOperation="source-over";var k=c.last._iNext;c=c.first;do if(d=c.worldTransform,c.visible){if(c.renderable)if(c instanceof e.Sprite){var h=c.texture.frame;h&&(f.globalAlpha=c.worldAlpha,f.setTransform(d[0],d[3],d[1],d[4],d[2],d[5]),f.drawImage(c.texture.baseTexture.source,h.x,h.y,h.width,h.height,c.anchor.x*-h.width,c.anchor.y*
-h.height,h.width,h.height))}else c instanceof e.Strip?(f.setTransform(d[0],d[3],d[1],d[4],d[2],d[5]),this.renderStrip(c)):c instanceof e.TilingSprite?(f.setTransform(d[0],d[3],d[1],d[4],d[2],d[5]),this.renderTilingSprite(c)):c instanceof e.CustomRenderable?c.renderCanvas(this):c instanceof e.Graphics?(f.setTransform(d[0],d[3],d[1],d[4],d[2],d[5]),e.CanvasGraphics.renderGraphics(c,f)):c instanceof e.FilterBlock&&(c.open?(f.save(),d=c.mask.alpha,h=c.mask.worldTransform,f.setTransform(h[0],h[3],h[1],
h[4],h[2],h[5]),c.mask.worldAlpha=0.5,f.worldAlpha=0,e.CanvasGraphics.renderGraphicsMask(c.mask,f),f.clip(),c.mask.worldAlpha=d):f.restore());c=c._iNext}else c=c.last._iNext;while(c!=k)};e.CanvasRenderer.prototype.renderStripFlat=function(c){var d=this.context;c=c.verticies;var f=c.length/2;this.count++;d.beginPath();for(var e=1;e<f-2;e++){var h=2*e,l=c[h+2],m=c[h+4],p=c[h+3],n=c[h+5];d.moveTo(c[h],c[h+1]);d.lineTo(l,p);d.lineTo(m,n)}d.fillStyle="#FF0000";d.fill();d.closePath()};e.CanvasRenderer.prototype.renderTilingSprite=
function(c){var d=this.context;d.globalAlpha=c.worldAlpha;c.__tilePattern||(c.__tilePattern=d.createPattern(c.texture.baseTexture.source,"repeat"));d.beginPath();var f=c.tilePosition,e=c.tileScale;d.scale(e.x,e.y);d.translate(f.x,f.y);d.fillStyle=c.__tilePattern;d.fillRect(-f.x,-f.y,c.width/e.x,c.height/e.y);d.scale(1/e.x,1/e.y);d.translate(-f.x,-f.y);d.closePath()};e.CanvasRenderer.prototype.renderStrip=function(c){var d=this.context,f=c.verticies,e=c.uvs,h=f.length/2;this.count++;for(var l=1;l<
h-2;l++){var m=2*l,p=f[m],n=f[m+2],t=f[m+4],q=f[m+1],u=f[m+3],s=f[m+5],w=e[m]*c.texture.width,A=e[m+2]*c.texture.width,x=e[m+4]*c.texture.width,C=e[m+1]*c.texture.height,D=e[m+3]*c.texture.height,m=e[m+5]*c.texture.height;d.save();d.beginPath();d.moveTo(p,q);d.lineTo(n,u);d.lineTo(t,s);d.closePath();d.clip();var B=w*D+C*x+A*m-D*x-C*A-w*m;d.transform((p*D+C*t+n*m-D*t-C*n-p*m)/B,(q*D+C*s+u*m-D*s-C*u-q*m)/B,(w*n+p*x+A*t-n*x-p*A-w*t)/B,(w*u+q*x+A*s-u*x-q*A-w*s)/B,(w*D*t+C*n*x+p*A*m-p*D*x-C*A*t-w*n*m)/
B,(w*D*s+C*u*x+q*A*m-q*D*x-C*A*s-w*u*m)/B);d.drawImage(c.texture.baseTexture.source,0,0);d.restore()}};e.CanvasGraphics=function(){};e.CanvasGraphics.renderGraphics=function(c,d){for(var f=c.worldAlpha,k=0;k<c.graphicsData.length;k++){var h=c.graphicsData[k],l=h.points;d.strokeStyle=color="#"+("00000"+(h.lineColor|0).toString(16)).substr(-6);d.lineWidth=h.lineWidth;if(h.type==e.Graphics.POLY){d.beginPath();d.moveTo(l[0],l[1]);for(var m=1;m<l.length/2;m++)d.lineTo(l[2*m],l[2*m+1]);l[0]==l[l.length-
2]&&l[1]==l[l.length-1]&&d.closePath();h.fill&&(d.globalAlpha=h.fillAlpha*f,d.fillStyle=color="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),d.fill());h.lineWidth&&(d.globalAlpha=h.lineAlpha*f,d.stroke())}else if(h.type==e.Graphics.RECT)h.fillColor&&(d.globalAlpha=h.fillAlpha*f,d.fillStyle=color="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),d.fillRect(l[0],l[1],l[2],l[3])),h.lineWidth&&(d.globalAlpha=h.lineAlpha*f,d.strokeRect(l[0],l[1],l[2],l[3]));else if(h.type==e.Graphics.CIRC)d.beginPath(),
d.arc(l[0],l[1],l[2],0,2*Math.PI),d.closePath(),h.fill&&(d.globalAlpha=h.fillAlpha*f,d.fillStyle=color="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),d.fill()),h.lineWidth&&(d.globalAlpha=h.lineAlpha*f,d.stroke());else if(h.type==e.Graphics.ELIP){var p=h.points,n=2*p[2],m=2*p[3],l=p[0]-n/2,p=p[1]-m/2;d.beginPath();var t=0.5522848*(n/2),q=0.5522848*(m/2),u=l+n,s=p+m,n=l+n/2,m=p+m/2;d.moveTo(l,m);d.bezierCurveTo(l,m-q,n-t,p,n,p);d.bezierCurveTo(n+t,p,u,m-q,u,m);d.bezierCurveTo(u,m+q,n+t,s,n,
s);d.bezierCurveTo(n-t,s,l,m+q,l,m);d.closePath();h.fill&&(d.globalAlpha=h.fillAlpha*f,d.fillStyle=color="#"+("00000"+(h.fillColor|0).toString(16)).substr(-6),d.fill());h.lineWidth&&(d.globalAlpha=h.lineAlpha*f,d.stroke())}}};e.CanvasGraphics.renderGraphicsMask=function(c,d){1<c.graphicsData.length&&console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object");for(var f=0;1>f;f++){var k=c.graphicsData[f],h=k.points;if(k.type==e.Graphics.POLY){d.beginPath();
d.moveTo(h[0],h[1]);for(k=1;k<h.length/2;k++)d.lineTo(h[2*k],h[2*k+1]);h[0]==h[h.length-2]&&h[1]==h[h.length-1]&&d.closePath()}else if(k.type==e.Graphics.RECT)d.beginPath(),d.rect(h[0],h[1],h[2],h[3]),d.closePath();else if(k.type==e.Graphics.CIRC)d.beginPath(),d.arc(h[0],h[1],h[2],0,2*Math.PI),d.closePath();else if(k.type==e.Graphics.ELIP){var l=k.points,m=2*l[2],k=2*l[3],h=l[0]-m/2,l=l[1]-k/2;d.beginPath();var p=0.5522848*(m/2),n=0.5522848*(k/2),t=h+m,q=l+k,m=h+m/2,k=l+k/2;d.moveTo(h,k);d.bezierCurveTo(h,
k-n,m-p,l,m,l);d.bezierCurveTo(m+p,l,t,k-n,t,k);d.bezierCurveTo(t,k+n,m+p,q,m,q);d.bezierCurveTo(m-p,q,h,k+n,h,k);d.closePath()}}};e.Graphics=function(){e.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineWidth=0;this.lineColor="black";this.graphicsData=[];this.currentPath={points:[]}};e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype);e.Graphics.prototype.constructor=e.Graphics;e.Graphics.prototype.lineStyle=function(c,d,f){0==this.currentPath.points.length&&
this.graphicsData.pop();this.lineWidth=c||0;this.lineColor=d||0;this.lineAlpha=void 0==f?1:f;this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY};this.graphicsData.push(this.currentPath)};e.Graphics.prototype.moveTo=function(c,d){0==this.currentPath.points.length&&this.graphicsData.pop();this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,
lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY};this.currentPath.points.push(c,d);this.graphicsData.push(this.currentPath)};e.Graphics.prototype.lineTo=function(c,d){this.currentPath.points.push(c,d);this.dirty=!0};e.Graphics.prototype.beginFill=function(c,d){this.filling=!0;this.fillColor=c||0;this.fillAlpha=void 0==d?1:d};e.Graphics.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1};e.Graphics.prototype.drawRect=
function(c,d,f,k){0==this.currentPath.points.length&&this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[c,d,f,k],type:e.Graphics.RECT};this.graphicsData.push(this.currentPath);this.dirty=!0};e.Graphics.prototype.drawCircle=function(c,d,f){0==this.currentPath.points.length&&this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,
lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[c,d,f,f],type:e.Graphics.CIRC};this.graphicsData.push(this.currentPath);this.dirty=!0};e.Graphics.prototype.drawElipse=function(c,d,f,k){0==this.currentPath.points.length&&this.graphicsData.pop();this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[c,d,f,k],type:e.Graphics.ELIP};this.graphicsData.push(this.currentPath);
this.dirty=!0};e.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=!1;this.clearDirty=this.dirty=!0;this.graphicsData=[]};e.Graphics.POLY=0;e.Graphics.RECT=1;e.Graphics.CIRC=2;e.Graphics.ELIP=3;e.Strip=function(c,d,f){e.DisplayObjectContainer.call(this);this.texture=c;this.blendMode=e.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(k){this.uvs=
[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=d;this.height=f;c.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind));this.renderable=!0};e.Strip.prototype=Object.create(e.DisplayObjectContainer.prototype);e.Strip.prototype.constructor=e.Strip;e.Strip.prototype.setTexture=
function(c){this.texture=c;this.width=c.frame.width;this.height=c.frame.height;this.updateFrame=!0};e.Strip.prototype.onTextureUpdate=function(c){this.updateFrame=!0};e.Rope=function(c,d){e.Strip.call(this,c);this.points=d;try{this.verticies=new Float32Array(4*d.length),this.uvs=new Float32Array(4*d.length),this.colors=new Float32Array(2*d.length),this.indices=new Uint16Array(2*d.length)}catch(f){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()};e.Rope.prototype=
Object.create(e.Strip.prototype);e.Rope.prototype.constructor=e.Rope;e.Rope.prototype.refresh=function(){var c=this.points;if(!(1>c.length)){var d=this.uvs,f=this.indices,e=this.colors;this.count-=0.2;d[0]=0;d[1]=1;d[2]=0;d[3]=1;e[0]=1;e[1]=1;f[0]=0;f[1]=1;for(var c=c.length,h=1;h<c;h++){var l=4*h,m=h/(c-1);d[l]=m;d[l+1]=0;d[l+2]=m;d[l+3]=1;l=2*h;e[l]=1;e[l+1]=1;l=2*h;f[l]=l;f[l+1]=l+1}}};e.Rope.prototype.updateTransform=function(){var c=this.points;if(!(1>c.length)){var d=this.verticies,f=c[0],k,
h=k=0,l=c[0];this.count-=0.2;d[0]=l.x+k;d[1]=l.y+h;d[2]=l.x-k;d[3]=l.y-h;for(var m=c.length,p=1;p<m;p++){var l=c[p],n=4*p;k=p<c.length-1?c[p+1]:l;h=-(k.x-f.x);k=k.y-f.y;var f=Math.sqrt(k*k+h*h),t=this.texture.height/2;k/=f;h/=f;k*=t;h*=t;d[n]=l.x+k;d[n+1]=l.y+h;d[n+2]=l.x-k;d[n+3]=l.y-h;f=l}e.DisplayObjectContainer.prototype.updateTransform.call(this)}};e.Rope.prototype.setTexture=function(c){this.texture=c;this.updateFrame=!0};e.TilingSprite=function(c,d,f){e.DisplayObjectContainer.call(this);this.texture=
c;this.width=d;this.height=f;this.tileScale=new e.Point(1,1);this.tilePosition=new e.Point(0,0);this.renderable=!0;this.blendMode=e.blendModes.NORMAL};e.TilingSprite.prototype=Object.create(e.DisplayObjectContainer.prototype);e.TilingSprite.prototype.constructor=e.TilingSprite;e.TilingSprite.prototype.setTexture=function(c){this.texture=c;this.updateFrame=!0};e.TilingSprite.prototype.onTextureUpdate=function(c){this.updateFrame=!0};e.Spine=function(c){e.DisplayObjectContainer.call(this);this.spineData=
e.AnimCache[c];if(!this.spineData)throw Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+c);this.skeleton=new n.Skeleton(this.spineData);this.skeleton.updateWorldTransform();this.stateData=new n.AnimationStateData(this.spineData);this.state=new n.AnimationState(this.stateData);this.slotContainers=[];c=0;for(var d=this.skeleton.drawOrder.length;c<d;c++){var f=this.skeleton.drawOrder[c],k=f.attachment,h=new e.DisplayObjectContainer;this.slotContainers.push(h);this.addChild(h);
k instanceof n.RegionAttachment&&(k=this.createSprite(f,k.rendererObject),f.currentSprite=k,h.addChild(k))}};e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype);e.Spine.prototype.constructor=e.Spine;e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var c=0.001*(Date.now()-this.lastTime);this.lastTime=Date.now();this.state.update(c);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform();for(var c=this.skeleton.drawOrder,d=0,f=c.length;d<
f;d++){var k=c[d],h=k.attachment,l=this.slotContainers[d];if(h instanceof n.RegionAttachment){if(h.rendererObject&&(!k.data.attachmentName||h.rendererObject.name!=k.data.attachmentName)){var m=h.rendererObject.name;void 0!==k.currentSprite&&(k.currentSprite.visible=!1);k.sprites=k.sprites||{};if(void 0!==k.sprites[m])k.sprites[m].visible=!0;else{var p=this.createSprite(k,h.rendererObject);l.addChild(p);k.data.attachmentName=h.rendererObject.name}k.currentSprite=k.sprites[m]}l.visible=!0;m=k.bone;
l.position.x=m.worldX+h.x*m.m00+h.y*m.m01;l.position.y=m.worldY+h.x*m.m10+h.y*m.m11;l.scale.x=m.worldScaleX;l.scale.y=m.worldScaleY;l.rotation=-(k.bone.worldRotation*Math.PI/180)}else l.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)};e.Spine.prototype.createSprite=function(c,d){var f=new e.Sprite(e.Texture.fromFrame(e.TextureCache[d.name]?d.name:d.name+".png"));f.scale=d.scale;f.rotation=d.rotation;f.anchor.x=f.anchor.y=0.5;c.sprites=c.sprites||{};return c.sprites[d.name]=
f};var n={BoneData:function(c,d){this.name=c;this.parent=d}};n.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1};n.SlotData=function(c,d){this.name=c;this.boneData=d};n.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null};n.Bone=function(c,d){this.data=c;this.parent=d;this.setToSetupPose()};n.Bone.yDown=!1;n.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(c,
d){var f=this.parent;null!=f?(this.worldX=this.x*f.m00+this.y*f.m01+f.worldX,this.worldY=this.x*f.m10+this.y*f.m11+f.worldY,this.worldScaleX=f.worldScaleX*this.scaleX,this.worldScaleY=f.worldScaleY*this.scaleY,this.worldRotation=f.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var e=this.worldRotation*Math.PI/180,f=Math.cos(e),e=Math.sin(e);this.m00=f*this.worldScaleX;this.m10=e*this.worldScaleX;
this.m01=-e*this.worldScaleY;this.m11=f*this.worldScaleY;c&&(this.m00=-this.m00,this.m01=-this.m01);d&&(this.m10=-this.m10,this.m11=-this.m11);n.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var c=this.data;this.x=c.x;this.y=c.y;this.rotation=c.rotation;this.scaleX=c.scaleX;this.scaleY=c.scaleY}};n.Slot=function(c,d,f){this.data=c;this.skeleton=d;this.bone=f;this.setToSetupPose()};n.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(c){this.attachment=
c;this._attachmentTime=this.skeleton.time},setAttachmentTime:function(c){this._attachmentTime=this.skeleton.time-c},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var c=this.data;this.r=c.r;this.g=c.g;this.b=c.b;this.a=c.a;for(var d=this.skeleton.data.slots,f=0,e=d.length;f<e;f++)if(d[f]==c){this.setAttachment(c.attachmentName?this.skeleton.getAttachmentBySlotIndex(f,c.attachmentName):null);break}}};n.Skin=function(c){this.name=c;this.attachments=
{}};n.Skin.prototype={addAttachment:function(c,d,f){this.attachments[c+":"+d]=f},getAttachment:function(c,d){return this.attachments[c+":"+d]},_attachAll:function(c,d){for(var f in d.attachments){var e=f.indexOf(":"),h=parseInt(f.substring(0,e)),l=f.substring(e+1),e=c.slots[h];e.attachment&&e.attachment.name==l&&(h=this.getAttachment(h,l))&&e.setAttachment(h)}}};n.Animation=function(c,d,f){this.name=c;this.timelines=d;this.duration=f};n.Animation.prototype={apply:function(c,d,f){f&&0!=this.duration&&
(d%=this.duration);f=this.timelines;for(var e=0,h=f.length;e<h;e++)f[e].apply(c,d,1)},mix:function(c,d,f,e){f&&0!=this.duration&&(d%=this.duration);f=this.timelines;for(var h=0,l=f.length;h<l;h++)f[h].apply(c,d,e)}};n.binarySearch=function(c,d,f){var e=0,h=Math.floor(c.length/f)-2;if(0==h)return f;for(var l=h>>>1;;){c[(l+1)*f]<=d?e=l+1:h=l;if(e==h)return(e+1)*f;l=e+h>>>1}};n.linearSearch=function(c,d,f){for(var e=0,h=c.length-f;e<=h;e+=f)if(c[e]>d)return e;return-1};n.Curves=function(c){this.curves=
[];this.curves.length=6*(c-1)};n.Curves.prototype={setLinear:function(c){this.curves[6*c]=0},setStepped:function(c){this.curves[6*c]=-1},setCurve:function(c,d,f,e,h){var l=0.1*0.1,m=0.1*l,p=3*0.1,n=3*l,l=6*l,t=6*m,q=2*-d+e,u=2*-f+h;e=3*(d-e)+1;h=3*(f-h)+1;c*=6;var s=this.curves;s[c]=d*p+q*n+e*m;s[c+1]=f*p+u*n+h*m;s[c+2]=q*l+e*t;s[c+3]=u*l+h*t;s[c+4]=e*t;s[c+5]=h*t},getCurvePercent:function(c,d){d=0>d?0:1<d?1:d;var f=6*c,e=this.curves,h=e[f];if(!h)return d;if(-1==h)return 0;for(var l=e[f+1],m=e[f+
2],p=e[f+3],n=e[f+4],t=e[f+5],f=h,e=l,q=8;;){if(f>=d)return h=f-h,l=e-l,l+(e-l)*(d-h)/(f-h);if(0==q)break;q--;h+=m;l+=p;m+=n;p+=t;f+=h;e+=l}return e+(1-e)*(d-f)/(1-f)}};n.RotateTimeline=function(c){this.curves=new n.Curves(c);this.frames=[];this.frames.length=2*c};n.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(c,d,f){c*=2;this.frames[c]=d;this.frames[c+1]=f},apply:function(c,d,f){var e=this.frames;if(!(d<e[0])){c=c.bones[this.boneIndex];
if(d>=e[e.length-2])e=c.data.rotation+e[e.length-1]-c.rotation;else{var h=n.binarySearch(e,d,2),l=e[h-1],m=e[h];d=1-(d-m)/(e[h-2]-m);d=this.curves.getCurvePercent(h/2-1,d);for(e=e[h+1]-l;180<e;)e-=360;for(;-180>e;)e+=360;e=c.data.rotation+(l+e*d)-c.rotation}for(;180<e;)e-=360;for(;-180>e;)e+=360;c.rotation+=e*f}}};n.TranslateTimeline=function(c){this.curves=new n.Curves(c);this.frames=[];this.frames.length=3*c};n.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/
3},setFrame:function(c,d,f,e){c*=3;this.frames[c]=d;this.frames[c+1]=f;this.frames[c+2]=e},apply:function(c,d,f){var e=this.frames;if(!(d<e[0]))if(c=c.bones[this.boneIndex],d>=e[e.length-3])c.x+=(c.data.x+e[e.length-2]-c.x)*f,c.y+=(c.data.y+e[e.length-1]-c.y)*f;else{var h=n.binarySearch(e,d,3),l=e[h-2],m=e[h-1],p=e[h];d=1-(d-p)/(e[h+-3]-p);d=this.curves.getCurvePercent(h/3-1,d);c.x+=(c.data.x+l+(e[h+1]-l)*d-c.x)*f;c.y+=(c.data.y+m+(e[h+2]-m)*d-c.y)*f}}};n.ScaleTimeline=function(c){this.curves=new n.Curves(c);
this.frames=[];this.frames.length=3*c};n.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(c,d,f,e){c*=3;this.frames[c]=d;this.frames[c+1]=f;this.frames[c+2]=e},apply:function(c,d,f){var e=this.frames;if(!(d<e[0]))if(c=c.bones[this.boneIndex],d>=e[e.length-3])c.scaleX+=(c.data.scaleX-1+e[e.length-2]-c.scaleX)*f,c.scaleY+=(c.data.scaleY-1+e[e.length-1]-c.scaleY)*f;else{var h=n.binarySearch(e,d,3),l=e[h-2],m=e[h-1],p=e[h];d=1-(d-p)/(e[h+-3]-
p);d=this.curves.getCurvePercent(h/3-1,d);c.scaleX+=(c.data.scaleX-1+l+(e[h+1]-l)*d-c.scaleX)*f;c.scaleY+=(c.data.scaleY-1+m+(e[h+2]-m)*d-c.scaleY)*f}}};n.ColorTimeline=function(c){this.curves=new n.Curves(c);this.frames=[];this.frames.length=5*c};n.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(c,d,f,e){c*=5;this.frames[c]=d;this.frames[c+1]=r;this.frames[c+2]=g;this.frames[c+3]=b;this.frames[c+4]=a},apply:function(c,d,f){var e=this.frames;
if(!(d<e[0]))if(c=c.slots[this.slotIndex],d>=e[e.length-5])f=e.length-1,c.r=e[f-3],c.g=e[f-2],c.b=e[f-1],c.a=e[f];else{var h=n.binarySearch(e,d,5),l=e[h-4],m=e[h-3],p=e[h-2],v=e[h-1],t=e[h];d=1-(d-t)/(e[h-5]-t);d=this.curves.getCurvePercent(h/5-1,d);l+=(e[h+1]-l)*d;m+=(e[h+2]-m)*d;p+=(e[h+3]-p)*d;e=v+(e[h+4]-v)*d;1>f?(c.r+=(l-c.r)*f,c.g+=(m-c.g)*f,c.b+=(p-c.b)*f,c.a+=(e-c.a)*f):(c.r=l,c.g=m,c.b=p,c.a=e)}}};n.AttachmentTimeline=function(c){this.curves=new n.Curves(c);this.frames=[];this.frames.length=
c;this.attachmentNames=[];this.attachmentNames.length=c};n.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(c,d,f){this.frames[c]=d;this.attachmentNames[c]=f},apply:function(c,d,f){f=this.frames;d<f[0]||(d=d>=f[f.length-1]?f.length-1:n.binarySearch(f,d,1)-1,d=this.attachmentNames[d],c.slots[this.slotIndex].setAttachment(d?c.getAttachmentBySlotIndex(this.slotIndex,d):null))}};n.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=
[];this.animations=[]};n.SkeletonData.prototype={defaultSkin:null,findBone:function(c){for(var d=this.bones,f=0,e=d.length;f<e;f++)if(d[f].name==c)return d[f];return null},findBoneIndex:function(c){for(var d=this.bones,f=0,e=d.length;f<e;f++)if(d[f].name==c)return f;return-1},findSlot:function(c){for(var d=this.slots,f=0,e=d.length;f<e;f++)if(d[f].name==c)return slot[f];return null},findSlotIndex:function(c){for(var d=this.slots,f=0,e=d.length;f<e;f++)if(d[f].name==c)return f;return-1},findSkin:function(c){for(var d=
this.skins,f=0,e=d.length;f<e;f++)if(d[f].name==c)return d[f];return null},findAnimation:function(c){for(var d=this.animations,f=0,e=d.length;f<e;f++)if(d[f].name==c)return d[f];return null}};n.Skeleton=function(c){this.data=c;this.bones=[];for(var d=0,f=c.bones.length;d<f;d++){var e=c.bones[d],h=e.parent?this.bones[c.bones.indexOf(e.parent)]:null;this.bones.push(new n.Bone(e,h))}this.slots=[];this.drawOrder=[];d=0;for(f=c.slots.length;d<f;d++)e=c.slots[d],h=this.bones[c.bones.indexOf(e.boneData)],
e=new n.Slot(e,this,h),this.slots.push(e),this.drawOrder.push(e)};n.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var c=this.flipX,d=this.flipY,f=this.bones,e=0,h=f.length;e<h;e++)f[e].updateWorldTransform(c,d)},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var c=this.bones,d=0,f=c.length;d<f;d++)c[d].setToSetupPose()},setSlotsToSetupPose:function(){for(var c=
this.slots,d=0,f=c.length;d<f;d++)c[d].setToSetupPose(d)},getRootBone:function(){return 0==this.bones.length?null:this.bones[0]},findBone:function(c){for(var d=this.bones,f=0,e=d.length;f<e;f++)if(d[f].data.name==c)return d[f];return null},findBoneIndex:function(c){for(var d=this.bones,f=0,e=d.length;f<e;f++)if(d[f].data.name==c)return f;return-1},findSlot:function(c){for(var d=this.slots,f=0,e=d.length;f<e;f++)if(d[f].data.name==c)return d[f];return null},findSlotIndex:function(c){for(var d=this.slots,
f=0,e=d.length;f<e;f++)if(d[f].data.name==c)return f;return-1},setSkinByName:function(c){var d=this.data.findSkin(c);if(!d)throw"Skin not found: "+c;this.setSkin(d)},setSkin:function(c){this.skin&&c&&c._attachAll(this,this.skin);this.skin=c},getAttachmentBySlotName:function(c,d){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(c),d)},getAttachmentBySlotIndex:function(c,d){if(this.skin){var f=this.skin.getAttachment(c,d);if(f)return f}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(c,
d):null},setAttachment:function(c,d){for(var f=this.slots,e=0,h=f.size;e<h;e++){var l=f[e];if(l.data.name==c){f=null;if(d&&(f=this.getAttachment(e,d),null==f))throw"Attachment not found: "+d+", for slot: "+c;l.setAttachment(f);return}}throw"Slot not found: "+c;},update:function(c){time+=c}};n.AttachmentType={region:0};n.RegionAttachment=function(){this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};n.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,
rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(c,d,f,e,h){var l=this.uvs;h?(l[2]=c,l[3]=e,l[4]=c,l[5]=d,l[6]=f,l[7]=d,l[0]=f,l[1]=e):(l[0]=c,l[1]=e,l[2]=c,l[3]=d,l[4]=f,l[5]=d,l[6]=f,l[7]=e)},updateOffset:function(){var c=this.width/this.regionOriginalWidth*this.scaleX,d=this.height/this.regionOriginalHeight*this.scaleY,f=-this.width/2*this.scaleX+this.regionOffsetX*c,e=-this.height/2*this.scaleY+this.regionOffsetY*
d,h=f+this.regionWidth*c,c=e+this.regionHeight*d,d=this.rotation*Math.PI/180,l=Math.cos(d),m=Math.sin(d),d=f*l+this.x,f=f*m,n=e*l+this.y,e=e*m,v=h*l+this.x,h=h*m,l=c*l+this.y,c=c*m,m=this.offset;m[0]=d-e;m[1]=n+f;m[2]=d-c;m[3]=l+f;m[4]=v-c;m[5]=l+h;m[6]=v-e;m[7]=n+h},computeVertices:function(c,d,e,k){c+=e.worldX;d+=e.worldY;var h=e.m00,l=e.m01,m=e.m10;e=e.m11;var n=this.offset;k[0]=n[0]*h+n[1]*l+c;k[1]=n[0]*m+n[1]*e+d;k[2]=n[2]*h+n[3]*l+c;k[3]=n[2]*m+n[3]*e+d;k[4]=n[4]*h+n[5]*l+c;k[5]=n[4]*m+n[5]*
e+d;k[6]=n[6]*h+n[7]*l+c;k[7]=n[6]*m+n[7]*e+d}};n.AnimationStateData=function(c){this.skeletonData=c;this.animationToMixTime={}};n.AnimationStateData.prototype={defaultMix:0,setMixByName:function(c,d,e){var k=this.skeletonData.findAnimation(c);if(!k)throw"Animation not found: "+c;c=this.skeletonData.findAnimation(d);if(!c)throw"Animation not found: "+d;this.setMix(k,c,e)},setMix:function(c,d,e){this.animationToMixTime[c.name+":"+d.name]=e},getMix:function(c,d){var e=this.animationToMixTime[c.name+
":"+d.name];return e?e:this.defaultMix}};n.AnimationState=function(c){this.data=c;this.queue=[]};n.AnimationState.prototype={current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(c){this.currentTime+=c;this.previousTime+=c;this.mixTime+=c;0<this.queue.length&&(c=this.queue[0],this.currentTime>=c.delay&&(this._setAnimation(c.animation,c.loop),this.queue.shift()))},apply:function(c){if(this.current)if(this.previous){this.previous.apply(c,
this.previousTime,this.previousLoop);var d=this.mixTime/this.mixDuration;1<=d&&(d=1,this.previous=null);this.current.mix(c,this.currentTime,this.currentLoop,d)}else this.current.apply(c,this.currentTime,this.currentLoop)},clearAnimation:function(){this.current=this.previous=null;this.queue.length=0},_setAnimation:function(c,d){this.previous=null;c&&this.current&&(this.mixDuration=this.data.getMix(this.current,c),0<this.mixDuration&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,
this.previousLoop=this.currentLoop));this.current=c;this.currentLoop=d;this.currentTime=0},setAnimationByName:function(c,d){var e=this.data.skeletonData.findAnimation(c);if(!e)throw"Animation not found: "+c;this.setAnimation(e,d)},setAnimation:function(c,d){this.queue.length=0;this._setAnimation(c,d)},addAnimationByName:function(c,d,e){var k=this.data.skeletonData.findAnimation(c);if(!k)throw"Animation not found: "+c;this.addAnimation(k,d,e)},addAnimation:function(c,d,e){var k={};k.animation=c;k.loop=
d;if(!e||0>=e)d=0==this.queue.length?this.current:this.queue[this.queue.length-1].animation,e=null!=d?d.duration-this.data.getMix(d,c)+(e||0):0;k.delay=e;this.queue.push(k)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}};n.SkeletonJson=function(c){this.attachmentLoader=c};n.SkeletonJson.prototype={scale:1,readSkeletonData:function(c){for(var d=new n.SkeletonData,e=c.bones,k=0,h=e.length;k<h;k++){var l=e[k],m=null;if(l.parent&&(m=d.findBone(l.parent),!m))throw"Parent bone not found: "+
l.parent;m=new n.BoneData(l.name,m);m.length=(l.length||0)*this.scale;m.x=(l.x||0)*this.scale;m.y=(l.y||0)*this.scale;m.rotation=l.rotation||0;m.scaleX=l.scaleX||1;m.scaleY=l.scaleY||1;d.bones.push(m)}e=c.slots;k=0;for(h=e.length;k<h;k++){l=e[k];m=d.findBone(l.bone);if(!m)throw"Slot bone not found: "+l.bone;var m=new n.SlotData(l.name,m),p=l.color;p&&(m.r=n.SkeletonJson.toColor(p,0),m.g=n.SkeletonJson.toColor(p,1),m.b=n.SkeletonJson.toColor(p,2),m.a=n.SkeletonJson.toColor(p,3));m.attachmentName=l.attachment;
d.slots.push(m)}var k=c.skins,v;for(v in k)if(k.hasOwnProperty(v)){var h=k[v],m=new n.Skin(v),t;for(t in h)if(h.hasOwnProperty(t)){var e=d.findSlotIndex(t),l=h[t],q;for(q in l)l.hasOwnProperty(q)&&(p=this.readAttachment(m,q,l[q]),null!=p&&m.addAttachment(e,q,p))}d.skins.push(m);"default"==m.name&&(d.defaultSkin=m)}c=c.animations;for(var u in c)c.hasOwnProperty(u)&&this.readAnimation(u,c[u],d);return d},readAttachment:function(c,d,e){d=e.name||d;c=n.AttachmentType[e.type||"region"];if(c==n.AttachmentType.region)return c=
new n.RegionAttachment,c.x=(e.x||0)*this.scale,c.y=(e.y||0)*this.scale,c.scaleX=e.scaleX||1,c.scaleY=e.scaleY||1,c.rotation=e.rotation||0,c.width=(e.width||32)*this.scale,c.height=(e.height||32)*this.scale,c.updateOffset(),c.rendererObject={},c.rendererObject.name=d,c.rendererObject.scale={},c.rendererObject.scale.x=c.scaleX,c.rendererObject.scale.y=c.scaleY,c.rendererObject.rotation=-c.rotation*Math.PI/180,c;throw"Unknown attachment type: "+c;},readAnimation:function(c,d,e){var k=[],h=0,l=d.bones,
m;for(m in l)if(l.hasOwnProperty(m)){var p=e.findBoneIndex(m);if(-1==p)throw"Bone not found: "+m;var v=l[m],t;for(t in v)if(v.hasOwnProperty(t)){var q=v[t];if("rotate"==t){var u=new n.RotateTimeline(q.length);u.boneIndex=p;for(var s=0,w=0,A=q.length;w<A;w++){var x=q[w];u.setFrame(s,x.time,x.angle);n.SkeletonJson.readCurve(u,s,x);s++}k.push(u);h=Math.max(h,u.frames[2*u.getFrameCount()-2])}else if("translate"==t||"scale"==t){var C=1;"scale"==t?u=new n.ScaleTimeline(q.length):(u=new n.TranslateTimeline(q.length),
C=this.scale);u.boneIndex=p;w=s=0;for(A=q.length;w<A;w++)x=q[w],u.setFrame(s,x.time,(x.x||0)*C,(x.y||0)*C),n.SkeletonJson.readCurve(u,s,x),s++;k.push(u);h=Math.max(h,u.frames[3*u.getFrameCount()-3])}else throw"Invalid timeline type for a bone: "+t+" ("+m+")";}}d=d.slots;for(var D in d)if(d.hasOwnProperty(D))for(t in l=d[D],m=e.findSlotIndex(D),l)if(l.hasOwnProperty(t))if(q=l[t],"color"==t){u=new n.ColorTimeline(q.length);u.slotIndex=m;w=s=0;for(A=q.length;w<A;w++){var x=q[w],B=x.color,p=n.SkeletonJson.toColor(B,
0),v=n.SkeletonJson.toColor(B,1),C=n.SkeletonJson.toColor(B,2),B=n.SkeletonJson.toColor(B,3);u.setFrame(s,x.time,p,v,C,B);n.SkeletonJson.readCurve(u,s,x);s++}k.push(u);h=Math.max(h,u.frames[5*u.getFrameCount()-5])}else if("attachment"==t){u=new n.AttachmentTimeline(q.length);u.slotIndex=m;w=s=0;for(A=q.length;w<A;w++)x=q[w],u.setFrame(s++,x.time,x.name);k.push(u);h=Math.max(h,u.frames[u.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+t+" ("+D+")";e.animations.push(new n.Animation(c,
k,h))}};n.SkeletonJson.readCurve=function(c,d,e){(e=e.curve)&&("stepped"==e?c.curves.setStepped(d):e instanceof Array&&c.curves.setCurve(d,e[0],e[1],e[2],e[3]))};n.SkeletonJson.toColor=function(c,d){if(8!=c.length)throw"Color hexidecimal length must be 8, recieved: "+c;return parseInt(c.substring(2*d,2),16)/255};n.Atlas=function(c,d){this.textureLoader=d;this.pages=[];this.regions=[];var e=new n.AtlasReader(c),k=[];k.length=4;for(var h=null;;){var l=e.readLine();if(null==l)break;l=e.trim(l);if(0==
l.length)h=null;else if(h){var m=new n.AtlasRegion;m.name=l;m.page=h;m.rotate="true"==e.readValue();e.readTuple(k);var l=parseInt(k[0]),p=parseInt(k[1]);e.readTuple(k);var v=parseInt(k[0]),t=parseInt(k[1]);m.u=l/h.width;m.v=p/h.height;m.rotate?(m.u2=(l+t)/h.width,m.v2=(p+v)/h.height):(m.u2=(l+v)/h.width,m.v2=(p+t)/h.height);m.x=l;m.y=p;m.width=Math.abs(v);m.height=Math.abs(t);4==e.readTuple(k)&&(m.splits=[parseInt(k[0]),parseInt(k[1]),parseInt(k[2]),parseInt(k[3])],4==e.readTuple(k)&&(m.pads=[parseInt(k[0]),
parseInt(k[1]),parseInt(k[2]),parseInt(k[3])],e.readTuple(k)));m.originalWidth=parseInt(k[0]);m.originalHeight=parseInt(k[1]);e.readTuple(k);m.offsetX=parseInt(k[0]);m.offsetY=parseInt(k[1]);m.index=parseInt(e.readValue());this.regions.push(m)}else h=new n.AtlasPage,h.name=l,h.format=n.Atlas.Format[e.readValue()],e.readTuple(k),h.minFilter=n.Atlas.TextureFilter[k[0]],h.magFilter=n.Atlas.TextureFilter[k[1]],m=e.readValue(),h.uWrap=n.Atlas.TextureWrap.clampToEdge,h.vWrap=n.Atlas.TextureWrap.clampToEdge,
"x"==m?h.uWrap=n.Atlas.TextureWrap.repeat:"y"==m?h.vWrap=n.Atlas.TextureWrap.repeat:"xy"==m&&(h.uWrap=h.vWrap=n.Atlas.TextureWrap.repeat),d.load(h,l),this.pages.push(h)}};n.Atlas.prototype={findRegion:function(c){for(var d=this.regions,e=0,k=d.length;e<k;e++)if(d[e].name==c)return d[e];return null},dispose:function(){for(var c=this.pages,d=0,e=c.length;d<e;d++)this.textureLoader.unload(c[d].rendererObject)},updateUVs:function(c){for(var d=this.regions,e=0,k=d.length;e<k;e++){var h=d[e];h.page==c&&
(h.u=h.x/c.width,h.v=h.y/c.height,h.rotate?(h.u2=(h.x+h.height)/c.width,h.v2=(h.y+h.width)/c.height):(h.u2=(h.x+h.width)/c.width,h.v2=(h.y+h.height)/c.height))}}};n.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};n.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};n.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};n.AtlasPage=function(){};n.AtlasPage.prototype=
{name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};n.AtlasRegion=function(){};n.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null};n.AtlasReader=function(c){this.lines=c.split(/\r\n|\r|\n/)};n.AtlasReader.prototype={index:0,trim:function(c){return c.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=
this.lines.length?null:this.lines[this.index++]},readValue:function(){var c=this.readLine(),d=c.indexOf(":");if(-1==d)throw"Invalid line: "+c;return this.trim(c.substring(d+1))},readTuple:function(c){var d=this.readLine(),e=d.indexOf(":");if(-1==e)throw"Invalid line: "+d;for(var k=0,e=e+1;3>k;k++){var h=d.indexOf(",",e);if(-1==h){if(0==k)throw"Invalid line: "+d;break}c[k]=this.trim(d.substr(e,h-e));e=h+1}c[k]=this.trim(d.substring(e));return k+1}};n.AtlasAttachmentLoader=function(c){this.atlas=c};
n.AtlasAttachmentLoader.prototype={newAttachment:function(c,d,e){switch(d){case n.AttachmentType.region:c=this.atlas.findRegion(e);if(!c)throw"Region not found in atlas: "+e+" ("+d+")";d=new n.RegionAttachment(e);d.rendererObject=c;d.setUVs(c.u,c.v,c.u2,c.v2,c.rotate);d.regionOffsetX=c.offsetX;d.regionOffsetY=c.offsetY;d.regionWidth=c.width;d.regionHeight=c.height;d.regionOriginalWidth=c.originalWidth;d.regionOriginalHeight=c.originalHeight;return d}throw"Unknown attachment type: "+d;}};e.AnimCache=
{};n.Bone.yDown=!0;e.CustomRenderable=function(){e.DisplayObject.call(this)};e.CustomRenderable.prototype=Object.create(e.DisplayObject.prototype);e.CustomRenderable.prototype.constructor=e.CustomRenderable;e.CustomRenderable.prototype.renderCanvas=function(c){};e.CustomRenderable.prototype.initWebGL=function(c){};e.CustomRenderable.prototype.renderWebGL=function(c,d){};e.BaseTextureCache={};e.texturesToUpdate=[];e.texturesToDestroy=[];e.BaseTexture=function(c){e.EventTarget.call(this);this.height=
this.width=100;this.hasLoaded=!1;if(this.source=c){if(this.source instanceof Image||this.source instanceof HTMLImageElement)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);else{var d=this;this.source.onload=function(){d.hasLoaded=!0;d.width=d.source.width;d.height=d.source.height;e.texturesToUpdate.push(d);d.dispatchEvent({type:"loaded",content:d})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,
e.texturesToUpdate.push(this);this._powerOf2=!1}};e.BaseTexture.prototype.constructor=e.BaseTexture;e.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.source.src=null);this.source=null;e.texturesToDestroy.push(this)};e.BaseTexture.fromImage=function(c,d){var f=e.BaseTextureCache[c];f||(f=new Image,d&&(f.crossOrigin=""),f.src=c,f=new e.BaseTexture(f),e.BaseTextureCache[c]=f);return f};e.TextureCache={};e.FrameCache={};e.Texture=function(c,d){e.EventTarget.call(this);d||
(this.noFrame=!0,d=new e.Rectangle(0,0,1,1));c instanceof e.Texture&&(c=c.baseTexture);this.baseTexture=c;this.frame=d;this.trim=new e.Point;this.scope=this;if(c.hasLoaded)this.noFrame&&(d=new e.Rectangle(0,0,c.width,c.height)),this.setFrame(d);else{var f=this;c.addEventListener("loaded",function(){f.onBaseTextureLoaded()})}};e.Texture.prototype.constructor=e.Texture;e.Texture.prototype.onBaseTextureLoaded=function(c){c=this.baseTexture;c.removeEventListener("loaded",this.onLoaded);this.noFrame&&
(this.frame=new e.Rectangle(0,0,c.width,c.height));this.noFrame=!1;this.width=this.frame.width;this.height=this.frame.height;this.scope.dispatchEvent({type:"update",content:this})};e.Texture.prototype.destroy=function(c){c&&this.baseTexture.destroy()};e.Texture.prototype.setFrame=function(c){this.frame=c;this.width=c.width;this.height=c.height;if(c.x+c.width>this.baseTexture.width||c.y+c.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+
this);this.updateFrame=!0;e.Texture.frameUpdates.push(this)};e.Texture.fromImage=function(c,d){var f=e.TextureCache[c];f||(f=new e.Texture(e.BaseTexture.fromImage(c,d)),e.TextureCache[c]=f);return f};e.Texture.fromFrame=function(c){var d=e.TextureCache[c];if(!d)throw Error("The frameId '"+c+"' does not exist in the texture cache "+this);return d};e.Texture.fromCanvas=function(c){c=new e.BaseTexture(c);return new e.Texture(c)};e.Texture.addTextureToCache=function(c,d){e.TextureCache[d]=c};e.Texture.removeTextureFromCache=
function(c){var d=e.TextureCache[c];e.TextureCache[c]=null;return d};e.Texture.frameUpdates=[];e.RenderTexture=function(c,d){e.EventTarget.call(this);this.width=c||100;this.height=d||100;this.indetityMatrix=e.mat3.create();this.frame=new e.Rectangle(0,0,this.width,this.height);e.gl?this.initWebGL():this.initCanvas()};e.RenderTexture.prototype=Object.create(e.Texture.prototype);e.RenderTexture.prototype.constructor=e.RenderTexture;e.RenderTexture.prototype.initWebGL=function(){var c=e.gl;this.glFramebuffer=
c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,this.glFramebuffer);this.glFramebuffer.width=this.width;this.glFramebuffer.height=this.height;this.baseTexture=new e.BaseTexture;this.baseTexture.width=this.width;this.baseTexture.height=this.height;this.baseTexture._glTexture=c.createTexture();c.bindTexture(c.TEXTURE_2D,this.baseTexture._glTexture);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.width,this.height,0,c.RGBA,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);
c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);this.baseTexture.isRender=!0;c.bindFramebuffer(c.FRAMEBUFFER,this.glFramebuffer);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.baseTexture._glTexture,0);this.projection=new e.Point(this.width/2,this.height/2);this.render=this.renderWebGL};e.RenderTexture.prototype.resize=function(c,d){this.width=
c;this.height=d;if(e.gl){this.projection.x=this.width/2;this.projection.y=this.height/2;var f=e.gl;f.bindTexture(f.TEXTURE_2D,this.baseTexture._glTexture);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,this.width,this.height,0,f.RGBA,f.UNSIGNED_BYTE,null)}else this.frame.width=this.width,this.frame.height=this.height,this.renderer.resize(this.width,this.height)};e.RenderTexture.prototype.initCanvas=function(){this.renderer=new e.CanvasRenderer(this.width,this.height,null,0);this.baseTexture=new e.BaseTexture(this.renderer.view);
this.frame=new e.Rectangle(0,0,this.width,this.height);this.render=this.renderCanvas};e.RenderTexture.prototype.renderWebGL=function(c,d,f){var k=e.gl;k.colorMask(!0,!0,!0,!0);k.viewport(0,0,this.width,this.height);k.bindFramebuffer(k.FRAMEBUFFER,this.glFramebuffer);f&&(k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT));var h=c.children;f=c.worldTransform;c.worldTransform=e.mat3.create();c.worldTransform[4]=-1;c.worldTransform[5]=2*this.projection.y;d&&(c.worldTransform[2]=d.x,c.worldTransform[5]-=
d.y);d=0;for(var l=h.length;d<l;d++)h[d].updateTransform();(h=c.__renderGroup)?c==h.root?h.render(this.projection):h.renderSpecific(c,this.projection):(this.renderGroup||(this.renderGroup=new e.WebGLRenderGroup(k)),this.renderGroup.setRenderable(c),this.renderGroup.render(this.projection));c.worldTransform=f};e.RenderTexture.prototype.renderCanvas=function(c,d,f){var k=c.children;c.worldTransform=e.mat3.create();d&&(c.worldTransform[2]=d.x,c.worldTransform[5]=d.y);d=0;for(var h=k.length;d<h;d++)k[d].updateTransform();
f&&this.renderer.context.clearRect(0,0,this.width,this.height);this.renderer.renderDisplayObject(c);this.renderer.context.setTransform(1,0,0,1,0,0)};e.AssetLoader=function(c,d){e.EventTarget.call(this);this.assetURLs=c;this.crossorigin=d;this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}};e.AssetLoader.prototype.constructor=e.AssetLoader;e.AssetLoader.prototype.load=
function(){var c=this;this.loadCount=this.assetURLs.length;for(var d=0;d<this.assetURLs.length;d++){var e=this.assetURLs[d],k=e.split(".").pop().toLowerCase(),h=this.loadersByType[k];if(!h)throw Error(k+" is an unsupported file type");e=new h(e,this.crossorigin);e.addEventListener("loaded",function(){c.onAssetLoaded()});e.load()}};e.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--;this.dispatchEvent({type:"onProgress",content:this});if(this.onProgress)this.onProgress();if(0==this.loadCount&&
(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete))this.onComplete()};e.JsonLoader=function(c,d){e.EventTarget.call(this);this.url=c;this.crossorigin=d;this.baseUrl=c.replace(/[^\/]*$/,"");this.loaded=!1};e.JsonLoader.prototype.constructor=e.JsonLoader;e.JsonLoader.prototype.load=function(){this.ajaxRequest=new M;var c=this;this.ajaxRequest.onreadystatechange=function(){c.onJSONLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");
this.ajaxRequest.send(null)};e.JsonLoader.prototype.onJSONLoaded=function(){if(4==this.ajaxRequest.readyState)if(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var c=this,d=new e.ImageLoader(this.baseUrl+this.json.meta.image,this.crossorigin),f=this.json.frames;this.texture=d.texture.baseTexture;d.addEventListener("loaded",function(d){c.onLoaded()});for(var k in f){var h=f[k].frame;h&&(e.TextureCache[k]=
new e.Texture(this.texture,{x:h.x,y:h.y,width:h.w,height:h.h}),f[k].trimmed&&(e.TextureCache[k].realSize=f[k].spriteSourceSize,e.TextureCache[k].trim.x=0))}d.load()}else this.json.bones&&(d=(new n.SkeletonJson).readSkeletonData(this.json),e.AnimCache[this.url]=d),this.onLoaded();else this.onError()};e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};e.AtlasLoader=
function(c,d){e.EventTarget.call(this);this.url=c;this.baseUrl=c.replace(/[^\/]*$/,"");this.crossorigin=d;this.loaded=!1};e.AtlasLoader.constructor=e.AtlasLoader;e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new M;var c=this;this.ajaxRequest.onreadystatechange=function(){c.onAtlasLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json");this.ajaxRequest.send(null)};e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4==
this.ajaxRequest.readyState)if(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http")){this.atlas={meta:{image:""},frames:{}};for(var c=this.ajaxRequest.responseText.split(/\r?\n/),d=-3,f=null,k=0;k<c.length;k++)if(c[k]=c[k].replace(/^\s+|\s+$/g,""),0<c[k].length){if(-3==d)this.atlas.meta.image=c[k];else if(0<d)if(1==d%7)null!=f&&(this.atlas.frames[f.name]=f),f={name:c[k],frame:{}};else{var h=c[k].split(" ");3==d%7?(f.frame.x=Number(h[1].replace(",","")),f.frame.y=Number(h[2])):4==
d%7?(f.frame.w=Number(h[1].replace(",","")),f.frame.h=Number(h[2])):5==d%7&&(h={x:0,y:0,w:Number(h[1].replace(",","")),h:Number(h[2])},h.w>f.frame.w||h.h>f.frame.h?(f.trimmed=!0,f.realSize=h):f.trimmed=!1)}d++}null!=f&&(this.atlas.frames[f.name]=f);if(this.atlas.frames){var l=this,c=new e.ImageLoader(this.baseUrl+this.atlas.meta.image,this.crossorigin),d=this.atlas.frames;this.texture=c.texture.baseTexture;c.addEventListener("loaded",function(c){l.onLoaded()});for(k in d)if(f=d[k].frame)e.TextureCache[k]=
new e.Texture(this.texture,{x:f.x,y:f.y,width:f.w,height:f.h}),!0==d[k].trimmed&&(e.TextureCache[k].realSize=d[k].realSize,e.TextureCache[k].trim.x=0,e.TextureCache[k].trim.y=0);c.load()}else this.onLoaded()}else this.onError()};e.AtlasLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})};e.ImageLoader=function(c,d){e.EventTarget.call(this);this.texture=e.Texture.fromImage(c,
d)};e.ImageLoader.prototype.constructor=e.ImageLoader;e.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var c=this;this.texture.baseTexture.addEventListener("loaded",function(){c.onLoaded()})}};e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};e.BitmapFontLoader=function(c,d){e.EventTarget.call(this);this.url=c;this.crossorigin=d;this.baseUrl=c.replace(/[^\/]*$/,"");this.texture=null};e.BitmapFontLoader.prototype.constructor=
e.BitmapFontLoader;e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var c=this;this.ajaxRequest.onreadystatechange=function(){c.onXMLLoaded()};this.ajaxRequest.open("GET",this.url,!0);this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml");this.ajaxRequest.send(null)};e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4==this.ajaxRequest.readyState&&(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))){var c=this.baseUrl+
this.ajaxRequest.responseXML.getElementsByTagName("page")[0].attributes.getNamedItem("file").nodeValue,c=new e.ImageLoader(c,this.crossorigin);this.texture=c.texture.baseTexture;var d={},f=this.ajaxRequest.responseXML.getElementsByTagName("info")[0],k=this.ajaxRequest.responseXML.getElementsByTagName("common")[0];d.font=f.attributes.getNamedItem("face").nodeValue;d.size=parseInt(f.attributes.getNamedItem("size").nodeValue,10);d.lineHeight=parseInt(k.attributes.getNamedItem("lineHeight").nodeValue,
10);d.chars={};k=this.ajaxRequest.responseXML.getElementsByTagName("char");for(f=0;f<k.length;f++){var h=parseInt(k[f].attributes.getNamedItem("id").nodeValue,10),l={x:parseInt(k[f].attributes.getNamedItem("x").nodeValue,10),y:parseInt(k[f].attributes.getNamedItem("y").nodeValue,10),width:parseInt(k[f].attributes.getNamedItem("width").nodeValue,10),height:parseInt(k[f].attributes.getNamedItem("height").nodeValue,10)};e.TextureCache[h]=new e.Texture(this.texture,l);d.chars[h]={xOffset:parseInt(k[f].attributes.getNamedItem("xoffset").nodeValue,
10),yOffset:parseInt(k[f].attributes.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(k[f].attributes.getNamedItem("xadvance").nodeValue,10),kerning:{},texture:new e.Texture(this.texture,l)}}k=this.ajaxRequest.responseXML.getElementsByTagName("kerning");for(f=0;f<k.length;f++){var h=parseInt(k[f].attributes.getNamedItem("first").nodeValue,10),l=parseInt(k[f].attributes.getNamedItem("second").nodeValue,10),m=parseInt(k[f].attributes.getNamedItem("amount").nodeValue,10);d.chars[l].kerning[h]=
m}e.BitmapText.fonts[d.font]=d;var n=this;c.addEventListener("loaded",function(){n.onLoaded()});c.load()}};e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})};e.SpineLoader=function(c,d){e.EventTarget.call(this);this.url=c;this.crossorigin=d;this.loaded=!1};e.SpineLoader.prototype.constructor=e.SpineLoader;e.SpineLoader.prototype.load=function(){var c=this,d=new e.JsonLoader(this.url,this.crossorigin);d.addEventListener("loaded",function(d){c.json=d.content.json;
c.onJSONLoaded()});d.load()};e.SpineLoader.prototype.onJSONLoaded=function(c){c=(new n.SkeletonJson).readSkeletonData(this.json);e.AnimCache[this.url]=c;this.onLoaded()};e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0;this.dispatchEvent({type:"loaded",content:this})};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports.PIXI=e):this.PIXI=e}).call(this);
